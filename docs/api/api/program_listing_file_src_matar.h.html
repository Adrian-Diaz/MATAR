<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Program Listing for File matar.h &mdash; matar  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/collapsible-lists/css/tree_view.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
        <script src="../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> matar
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="library_root.html">Library API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">matar</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Program Listing for File matar.h</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/program_listing_file_src_matar.h.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="program-listing-for-file-matar-h">
<span id="program-listing-file-src-matar-h"></span><h1>Program Listing for File matar.h<a class="headerlink" href="#program-listing-for-file-matar-h" title="Permalink to this headline"></a></h1>
<p>↰ <a class="reference internal" href="file_src_matar.h.html#file-src-matar-h"><span class="std std-ref">Return to documentation for file</span></a> (<code class="docutils literal notranslate"><span class="pre">src/matar.h</span></code>)</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifndef MATAR_H</span>
<span class="cp">#define MATAR_H</span>
<span class="cm">/**********************************************************************************************</span>
<span class="cm"> © 2020. Triad National Security, LLC. All rights reserved.</span>
<span class="cm"> This program was produced under U.S. Government contract 89233218CNA000001 for Los Alamos</span>
<span class="cm"> National Laboratory (LANL), which is operated by Triad National Security, LLC for the U.S.</span>
<span class="cm"> Department of Energy/National Nuclear Security Administration. All rights in the program are</span>
<span class="cm"> reserved by Triad National Security, LLC, and the U.S. Department of Energy/National Nuclear</span>
<span class="cm"> Security Administration. The Government is granted for itself and others acting on its behalf a</span>
<span class="cm"> nonexclusive, paid-up, irrevocable worldwide license in this material to reproduce, prepare</span>
<span class="cm"> derivative works, distribute copies to the public, perform publicly and display publicly, and</span>
<span class="cm"> to permit others to do so.</span>
<span class="cm"> This program is open source under the BSD-3 License.</span>
<span class="cm"> Redistribution and use in source and binary forms, with or without modification, are permitted</span>
<span class="cm"> provided that the following conditions are met:</span>

<span class="cm"> 1.  Redistributions of source code must retain the above copyright notice, this list of</span>
<span class="cm"> conditions and the following disclaimer.</span>

<span class="cm"> 2.  Redistributions in binary form must reproduce the above copyright notice, this list of</span>
<span class="cm"> conditions and the following disclaimer in the documentation and/or other materials</span>
<span class="cm"> provided with the distribution.</span>

<span class="cm"> 3.  Neither the name of the copyright holder nor the names of its contributors may be used</span>
<span class="cm"> to endorse or promote products derived from this software without specific prior</span>
<span class="cm"> written permission.</span>
<span class="cm"> THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS</span>
<span class="cm"> IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="cm"> IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR</span>
<span class="cm"> PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR</span>
<span class="cm"> CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</span>
<span class="cm"> EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,</span>
<span class="cm"> PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<span class="cm"> OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,</span>
<span class="cm"> WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR</span>
<span class="cm"> OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF</span>
<span class="cm"> ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="cm"> **********************************************************************************************/</span><span class="w"></span>

<span class="c1">// Order</span>
<span class="c1">//</span>
<span class="c1">//  Standard (non-Kokkos data structures)</span>
<span class="c1">//   1. FArray</span>
<span class="c1">//   2. ViewFArray</span>
<span class="c1">//   3. FMatrix</span>
<span class="c1">//   4. ViewFMatrix</span>
<span class="c1">//   5. CArray</span>
<span class="c1">//   6. ViewCArray</span>
<span class="c1">//   7. CMatrix</span>
<span class="c1">//   8. ViewCMatrix</span>
<span class="c1">//   9. RaggedRightArray</span>
<span class="c1">//   10. RaggedDownArray</span>
<span class="c1">//   11. DynamicRaggedRightArray</span>
<span class="c1">//   12. DynamicRaggedDownArray</span>
<span class="c1">//   13. CSRArray</span>
<span class="c1">//   14. CSCArray</span>
<span class="c1">//   15. CSRArray</span>
<span class="c1">//   16. CSCArray //todo</span>
<span class="c1">//</span>
<span class="c1">//   Kokkos Data structures</span>
<span class="c1">//   17. FArrayKokkos</span>
<span class="c1">//   18. ViewFArrayKokkos</span>
<span class="c1">//   19. FMatrixKokkos</span>
<span class="c1">//   20. ViewFMatrixKokkos</span>
<span class="c1">//   21. CArrayKokkos</span>
<span class="c1">//   22. ViewCArrayKokkos</span>
<span class="c1">//   23. CMatrixKokkos</span>
<span class="c1">//   24. ViewCMatrixKokkos</span>
<span class="c1">//   25. RaggedRightArrayKokkos</span>
<span class="c1">//   26. RaggedDownArrayKokkos</span>
<span class="c1">//   27. DynamicRaggedRightArrayKokkos</span>
<span class="c1">//   28. DynamicRaggedDownArrayKokkos</span>
<span class="c1">//   29. CSRArrayKokkos</span>
<span class="c1">//   29. CSCArrayKokkos</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;assert.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span><span class="c1"> // for shared_ptr</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;macros.h&quot;</span><span class="cp"></span>

<span class="k">using</span><span class="w"> </span><span class="n">real_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">double</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">u_int</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="p">;</span><span class="w"></span>


<span class="cp">#ifdef HAVE_KOKKOS</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Kokkos_Core.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Kokkos_DualView.hpp&gt;</span><span class="cp"></span>

<span class="k">using</span><span class="w"> </span><span class="n">HostSpace</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">HostSpace</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">MemoryUnmanaged</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">MemoryUnmanaged</span><span class="p">;</span><span class="w"></span>

<span class="cp">#ifdef HAVE_CUDA</span>
<span class="c1">//using UVMMemSpace     = Kokkos::CudaUVMSpace;</span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultMemSpace</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">CudaSpace</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">Cuda</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">LayoutLeft</span><span class="p">;</span><span class="w"></span>
<span class="cp">#elif HAVE_OPENMP</span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultMemSpace</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">HostSpace</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">OpenMP</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">LayoutRight</span><span class="p">;</span><span class="w"></span>
<span class="cp">#elif HAVE_THREADS</span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultMemSpace</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">HostSpace</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">Threads</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">LayoutLeft</span><span class="p">;</span><span class="w"></span>
<span class="cp">#elif HAVE_HIP</span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultMemSpace</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">Experimental</span><span class="o">::</span><span class="n">HIPSpace</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">Experimental</span><span class="o">::</span><span class="n">HIP</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">LayoutLeft</span><span class="p">;</span><span class="w"></span>
<span class="cp">#else</span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultMemSpace</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">Serial</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">Serial</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">LayoutLeft</span><span class="p">;</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="c1">//MACROS to make the code less scary</span>
<span class="cp">#define kmalloc(size) ( Kokkos::kokkos_malloc&lt;DefaultMemSpace&gt;(size) )</span>
<span class="cp">#define kfree(pnt)        (  Kokkos::kokkos_free(pnt) )</span>
<span class="cp">#define ProfileRegionStart  ( Kokkos::Profiling::pushRegion )</span>
<span class="cp">#define ProfileRegionEnd  ( Kokkos::Profiling::popRegion )</span>
<span class="cp">#define DEFAULTSTRINGARRAY &quot;array_&quot;</span>
<span class="cp">#define DEFAULTSTRINGMATRIX &quot;matrix_&quot;</span>

<span class="k">using</span><span class="w"> </span><span class="n">policy1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">RangePolicy</span><span class="o">&lt;</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">policy2D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">MDRangePolicy</span><span class="o">&lt;</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">Rank</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">policy3D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">MDRangePolicy</span><span class="o">&lt;</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">Rank</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">policy4D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">MDRangePolicy</span><span class="o">&lt;</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">Rank</span><span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">using</span><span class="w"> </span><span class="n">TeamPolicy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">TeamPolicy</span><span class="o">&lt;</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="c1">//using mdrange_policy2 = Kokkos::MDRangePolicy&lt;Kokkos::Rank&lt;2&gt;&gt;;</span>
<span class="c1">//using mdrange_policy3 = Kokkos::MDRangePolicy&lt;Kokkos::Rank&lt;3&gt;&gt;;</span>

<span class="k">using</span><span class="w"> </span><span class="n">RMatrix1D</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">real_t</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">RMatrix2D</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">real_t</span><span class="w"> </span><span class="o">**</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">RMatrix3D</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">real_t</span><span class="w"> </span><span class="o">***</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">RMatrix4D</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">real_t</span><span class="w"> </span><span class="o">****</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">RMatrix5D</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">real_t</span><span class="w"> </span><span class="o">*****</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">IMatrix1D</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">IMatrix2D</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">int</span><span class="w"> </span><span class="o">**</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">IMatrix3D</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">int</span><span class="w"> </span><span class="o">***</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">IMatrix4D</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">int</span><span class="w"> </span><span class="o">****</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">IMatrix5D</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">int</span><span class="w"> </span><span class="o">*****</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">SVar</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">SArray2D</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="o">**</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">SArray3D</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="o">***</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">SArray4D</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="o">****</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">SArray5D</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*****</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">DefaultExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">using</span><span class="w"> </span><span class="n">SHArray1D</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">DefaultLayout</span><span class="p">,</span><span class="n">Kokkos</span><span class="o">::</span><span class="n">HostSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="cp">#endif</span>

<span class="c1">//To disable asserts, uncomment the following line</span>
<span class="c1">//#define NDEBUG</span>


<span class="c1">//---Begin Standard Data Structures---</span>

<span class="c1">//1. FArray</span>
<span class="c1">// indicies are [0:N-1]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">FArray</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">    </span><span class="c1">// default constructor</span>
<span class="w">   </span><span class="n">FArray</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//overload constructors from 1D to 7D</span>

<span class="w">   </span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">   </span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FArray</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// overload operator() to access data as array(i,....,n);</span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//overload = operator</span>
<span class="w">    </span><span class="n">FArray</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return array size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return array dims</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return array order (rank)</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return pointer</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// deconstructor</span>
<span class="w">    </span><span class="o">~</span><span class="n">FArray</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// end of f_array_t</span>

<span class="c1">//---FArray class definnitions----</span>

<span class="c1">//constructors</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FArray</span><span class="p">(){</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="o">*</span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="o">*</span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="o">*</span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="o">*</span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="o">*</span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="o">*</span><span class="n">dim3</span><span class="o">*</span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="o">*</span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="o">*</span><span class="n">dim3</span><span class="o">*</span><span class="n">dim4</span><span class="o">*</span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="o">*</span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="o">*</span><span class="n">dim3</span><span class="o">*</span><span class="n">dim4</span><span class="o">*</span><span class="n">dim5</span><span class="o">*</span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>

<span class="c1">//Copy constructor</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FArray</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="c1">// end if</span>

<span class="p">}</span><span class="w"> </span><span class="c1">// end constructor</span>

<span class="c1">//overload operator () for 1D to 7D</span>
<span class="c1">//indices are from [0:N-1]</span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArray 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArray 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArray 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArray 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FArray 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in Farray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FArray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArray 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArray 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FArray 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FArray 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FArray 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in FArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in FArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in FArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">n</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                         </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in FArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in FArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in FArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">n</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">o</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// = operator</span>
<span class="c1">//THIS = FArray &lt;&gt; TEMP(n,m,...)</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;FArray order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to FArray dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//delete FArray</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">FArray</span><span class="p">(){}</span><span class="w"></span>

<span class="c1">//---end of FArray class definitions----</span>


<span class="c1">//2. ViewFArray</span>
<span class="c1">// indicies are [0:N-1]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">ViewFArray</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"> </span><span class="c1">// Length of 1D array</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">    </span><span class="c1">// default constructor</span>
<span class="w">    </span><span class="n">ViewFArray</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//---1D to 7D array ---</span>
<span class="w">    </span><span class="n">ViewFArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewFArray</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewFArray</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewFArray</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewFArray</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewFArray</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewFArray</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// calculate C = math(A,B)</span>
<span class="w">    </span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">M</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="w"> </span><span class="n">do_this_math</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return array size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return array dims</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return array order (rank)</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return pointer</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// end of viewFArray</span>

<span class="c1">//class definitions for viewFArray</span>

<span class="c1">//~~~~constructors for viewFArray for 1D to 7D~~~~~~~</span>

<span class="c1">//no dimension</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArray</span><span class="p">(){</span><span class="w"></span>
<span class="w">  </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="o">*</span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="o">*</span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="o">*</span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="o">*</span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="o">*</span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="o">*</span><span class="n">dim3</span><span class="o">*</span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="o">*</span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="o">*</span><span class="n">dim3</span><span class="o">*</span><span class="n">dim4</span><span class="o">*</span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="o">*</span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="o">*</span><span class="n">dim3</span><span class="o">*</span><span class="n">dim4</span><span class="o">*</span><span class="n">dim5</span><span class="o">*</span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//~~~~~~operator () overload</span>
<span class="c1">//for dimensions 1D to 7D</span>
<span class="c1">//indices for array are from 0...N-1</span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArray 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArray 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArray 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArray 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFArray 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFArray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFArray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArray 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArray 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFArray 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFArray 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFArray 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewFArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewFArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewFArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">n</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewFArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewFArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewFArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">l</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">n</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="n">o</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// calculate this ViewFArray object = math(A,B)</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">M</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="w"> </span><span class="n">do_this_math</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">do_this_math</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"> </span><span class="c1">// pass in this ViewFArray object</span>
<span class="p">}</span><span class="c1">// end of math opperation</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;ViewFArray order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to ViewFArray dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">ViewFArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//---end of ViewFArray class definitions---</span>


<span class="c1">//3. FMatrix</span>
<span class="c1">// indicies are [1:N]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">FMatrix</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"> </span><span class="c1">// Length of 1D array</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">matrix_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Default constructor</span>
<span class="w">    </span><span class="n">FMatrix</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//---1D to 7D matrix ---</span>
<span class="w">    </span><span class="n">FMatrix</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrix</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrix</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrix</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrix</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrix</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrix</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrix</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>


<span class="w">    </span><span class="c1">// Overload copy assignment operator</span>
<span class="w">    </span><span class="n">FMatrix</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// the length of the 1D storage array</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// matrix dims</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return matrix order (rank)</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return pointer</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Deconstructor</span>
<span class="w">    </span><span class="o">~</span><span class="n">FMatrix</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// End of FMatrix</span>

<span class="c1">//---FMatrix class definitions---</span>

<span class="c1">//constructors</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FMatrix</span><span class="p">(){</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">FMatrix</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="c1">// end if</span>

<span class="p">}</span><span class="w"> </span><span class="c1">// end constructor</span>


<span class="c1">//overload operators</span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrix 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrix 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrix 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrix 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FMatrix 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrix 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrix 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FMatrix 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FMatrix 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrix 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrix 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FMatrix 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FMatrix 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FMatrix 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in FMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in FMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in FMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in FMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in FMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in FMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">o</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Do nothing if assignment is of the form x = x</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="o">--</span><span class="p">;</span><span class="w"> </span><span class="c1">// i starts at 1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;FMatrix order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to FMatrix dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">FMatrix</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">//----end of FMatrix class definitions----</span>


<span class="c1">//4. ViewFMatrix</span>
<span class="c1">//  indices are [1:N]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">ViewFMatrix</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"> </span><span class="c1">// Length of 1D array</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">matrix_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Default constructor</span>
<span class="w">    </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//--- 1D to 7D matrix ---</span>

<span class="w">    </span><span class="n">ViewFMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewFMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">some_matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewFMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewFMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// calculate C = math(A,B)</span>
<span class="w">    </span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">M</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="w"> </span><span class="n">do_this_math</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// length of 1D array</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// matrix dims</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return matrix order (rank)</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return pointer</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// end of ViewFMatrix</span>

<span class="c1">//constructors</span>

<span class="c1">//no dimension</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrix</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                             </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="c1">//overload operator ()</span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrix 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrix 1D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrix 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrix 2D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFMatrix 2D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrix 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrix 3D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFMatrix 3D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFMatrix 3D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim3</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrix 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrix 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFMatrix 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFMatrix 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim3</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFMatrix 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim4</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrix 5D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFMatrix 5D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFMatrix 5D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim3</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFMatrix 5D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim4</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewFMatrix 5D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim5</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrix 6D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFMatrix 6D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFMatrix 6D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim3</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFMatrix 6D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim4</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewFMatrix 6D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim5</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewFMatrix 6D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim6</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrix 7D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFMatrix 7D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFMatrix 7D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim3</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFMatrix 7D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim4</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewFMatrix 7D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim5</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewFMatrix 7D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim6</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in ViewFMatrix 7D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim7</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">o</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// calculate this ViewFMatrix object = math(A,B)</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">M</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="w"> </span><span class="n">do_this_math</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">do_this_math</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"> </span><span class="c1">// pass in this ViewFArray object</span>
<span class="p">}</span><span class="c1">// end of math opperation</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="o">--</span><span class="p">;</span><span class="w"> </span><span class="c1">// i starts at 1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;ViewFMatrix order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to ViewFMatrix dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="c1">//-----end ViewFMatrix-----</span>


<span class="c1">//5. CArray</span>
<span class="c1">// indicies are [0:N-1]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">CArray</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"> </span><span class="c1">// Length of 1D array</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Default constructor</span>
<span class="w">    </span><span class="n">CArray</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// --- 1D to 7D array ---</span>

<span class="w">    </span><span class="n">CArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CArray</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload operator()</span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload copy assignment operator</span>
<span class="w">    </span><span class="n">CArray</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">     </span><span class="c1">//return array size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return array dims</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return array order (rank)</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return pointer</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Deconstructor</span>
<span class="w">    </span><span class="o">~</span><span class="n">CArray</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// End of CArray</span>

<span class="c1">//---carray class declarations---</span>

<span class="c1">//constructors</span>

<span class="c1">//no dim</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CArray</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//Copy constructor</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CArray</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="c1">// end if</span>

<span class="p">}</span><span class="w"> </span><span class="c1">// end constructor</span>


<span class="c1">//overload () operator</span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArray 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArray 1D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArray 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArray 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CArray 2D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w">  </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in Carray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CArray 3D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w">  </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArray 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArray 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim0</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CArray 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CArray 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CArray 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim3</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w">  </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in CArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w">  </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in CArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in CArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w">  </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in CArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in CArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in CArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">o</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w">  </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>


<span class="c1">//overload = operator</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>



<span class="c1">//return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;CArray order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to CArray dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//destructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">CArray</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">//----endof carray class definitions----</span>


<span class="c1">//6. ViewCArray</span>
<span class="c1">// indicies are [0:N-1]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">ViewCArray</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"> </span><span class="c1">// Length of 1D array</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Default constructor</span>
<span class="w">    </span><span class="n">ViewCArray</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//--- 1D to 7D array ---</span>
<span class="w">    </span><span class="n">ViewCArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewCArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewCArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">some_array</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewCArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">some_array</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewCArray</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">some_array</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewCArray</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">some_array</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewCArray</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">some_array</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// calculate C = math(A,B)</span>
<span class="w">    </span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">M</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="w"> </span><span class="n">do_this_math</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return array size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return array dims</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return array order (rank)</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return pointer</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// end of ViewCArray</span>

<span class="c1">//class definitions</span>

<span class="c1">//constructors</span>

<span class="c1">//no dim</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArray</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArray</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArray</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//overload () operator</span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArray 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArray 1D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="cm">/*</span>
<span class="cm">//specification for CArray type</span>
<span class="cm">//1D</span>
<span class="cm">template &lt;typename T&gt;</span>
<span class="cm">inline T&amp; ViewCArray&lt;CArray&lt;T&gt;&gt;::operator()(size_t i) const</span>
<span class="cm">{</span>
<span class="cm">    assert(i &lt; dim1_ &amp;&amp; &quot;i is out of bounds in c_array 1D&quot;);  // die if &gt;= dim1</span>

<span class="cm">    return (*this_array_)(i);</span>
<span class="cm">}</span>
<span class="cm">*/</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArray 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArray 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCArray 2D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w">  </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCarray 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCArray 3D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w">  </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArray 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArray 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim0</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCArray 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCArray 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewCArray 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim3</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w">  </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewCArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewCArray 5D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w">  </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewCArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewCArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewCArray 6D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w">  </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewCArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewCArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewCArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in ViewCArray 7D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">o</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                    </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w">  </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="c1">// calculate this ViewFArray object = math(A,B)</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">M</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="w"> </span><span class="n">do_this_math</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">do_this_math</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"> </span><span class="c1">// pass in this ViewFArray object</span>
<span class="p">}</span><span class="c1">// end of math opperation</span>

<span class="c1">//return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;ViewCArray order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to ViewCArray dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//---end of ViewCArray class definitions----</span>


<span class="c1">//7. CMatrix</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">CMatrix</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"> </span><span class="c1">// Length of 1D array</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">matrix_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">    </span><span class="c1">// default constructor</span>
<span class="w">    </span><span class="n">CMatrix</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrix</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrix</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrix</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CMatrix</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//overload operators to access data</span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//overload = operator</span>
<span class="w">    </span><span class="n">CMatrix</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CMatrix</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return array size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return array dims</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return array order (rank)</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return pointer</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// deconstructor</span>
<span class="w">    </span><span class="o">~</span><span class="n">CMatrix</span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// end of CMatrix</span>

<span class="c1">// CMatrix class definitions</span>

<span class="c1">//constructors</span>

<span class="c1">//no dim</span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CMatrix</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CMatrix</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CMatrix</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CMatrix</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="c1">// end if</span>

<span class="p">}</span><span class="w"> </span><span class="c1">// end constructor</span>

<span class="c1">//overload () operator</span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrix 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrix 1D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrix 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrix 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CMatrix 2D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">j</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrix 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrix 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CMatrix 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CMatrix 3D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">k</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrix 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrix 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim0</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CMatrix 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CMatrix 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CMatrix 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim3</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">l</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in CMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">m</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in CMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in CMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                          </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in CMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in CMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in CMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">o</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//overload = operator</span>
<span class="c1">//THIS = CMatrix&lt;&gt; temp</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CMatrix</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="o">--</span><span class="p">;</span><span class="w"> </span><span class="c1">// i starts at 1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;CMatrix order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to CMatrix dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Destructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">CMatrix</span><span class="p">(){}</span><span class="w"></span>

<span class="c1">//----end of CMatrix class definitions----</span>


<span class="c1">//8. ViewCMatrix</span>
<span class="c1">//  indices [1:N]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">ViewCMatrix</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"> </span><span class="c1">// Length of 1D array</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">     </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">matrix_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">    </span><span class="c1">// default constructor</span>
<span class="w">    </span><span class="n">ViewCMatrix</span><span class="p">();</span><span class="w"></span>


<span class="w">    </span><span class="c1">//--- 1D array ---</span>
<span class="w">    </span><span class="c1">// overloaded constructor</span>
<span class="w">    </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// calculate C = math(A,B)</span>
<span class="w">    </span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">M</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="w"> </span><span class="n">do_this_math</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return array size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return array dims</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return array order (rank)</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// return pointer</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// end of ViewCMatrix</span>

<span class="c1">//class definitions</span>

<span class="c1">//constructors</span>

<span class="c1">//no dim</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrix</span><span class="p">(){</span><span class="w"></span>
<span class="w">  </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrix</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">matrix</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">matrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//overload () operator</span>

<span class="c1">//1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="w"> </span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrix 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCMatrix 1D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrix 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCMatrix 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCMatrix 2D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">j</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrix 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCMatrix 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCMatrix 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCMatrix 3D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">k</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrix 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCMatrix 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim0</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCMatrix 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCMatrix 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewCMatrix 4D&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim3</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">l</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewCMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewCMatrix 5D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">m</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewCMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewCMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewCMatrix 6D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">n</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewCMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewCMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewCMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in ViewCMatrix 7D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">[(</span><span class="n">o</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="mi">-1</span><span class="p">)</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// calculate this ViewFArray object = math(A,B)</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">M</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="n">M</span><span class="w"> </span><span class="n">do_this_math</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">do_this_math</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span><span class="w"> </span><span class="c1">// pass in this ViewFArray object</span>
<span class="p">}</span><span class="c1">// end of math opperation</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="o">--</span><span class="p">;</span><span class="w"> </span><span class="c1">// i starts at 1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;ViewCMatrix order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to ViewCMatrix dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">matrix_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="c1">//----end of ViewCMatrix class definitions----</span>

<span class="c1">//9. RaggedRightArray</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">RaggedRightArray</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_saved_</span><span class="p">;</span><span class="w"> </span><span class="c1">// the number saved in the 1D array</span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Default constructor</span>
<span class="w">    </span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//--- 2D array access of a ragged right array ---</span>

<span class="w">    </span><span class="c1">// Overload constructor for a CArray</span>
<span class="w">    </span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload constructor for a ViewCArray</span>
<span class="w">    </span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overloaded constructor for a traditional array</span>
<span class="w">    </span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload constructor for a RaggedRightArray to</span>
<span class="w">    </span><span class="c1">// support a dynamically built stride_array</span>
<span class="w">    </span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">buffer</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Copy constructor</span>
<span class="w">    </span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedRightArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return the stride size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to increase the number of column entries, i.e.,</span>
<span class="w">    </span><span class="c1">// the stride size. Used with the constructor for building</span>
<span class="w">    </span><span class="c1">// the stride_array dynamically.</span>
<span class="w">    </span><span class="c1">// DO NOT USE with the constructures with a strides_array</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">push_back</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload operator() to access data as array(i,j)</span>
<span class="w">    </span><span class="c1">// where i=[0:N-1], j=[stride(i)]</span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// method to return total size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return pointer</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//get row starts array</span>
<span class="w">    </span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="nf">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">RaggedRightArray</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">RaggedRightArray</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Destructor</span>
<span class="w">    </span><span class="o">~</span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">// End of RaggedRightArray</span>

<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="c1">// Overloaded constructor with CArray</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="c1">// The length of the stride array is some_dim1;</span>
<span class="w">    </span><span class="n">dim1_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create and initialize the starting index of the entries in the 1D array</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[(</span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span><span class="w"> </span><span class="c1">// note the dim1+1</span>
<span class="w">    </span><span class="n">start_index_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// the 1D array starts at 0</span>

<span class="w">    </span><span class="c1">// Loop over to find the total length of the 1D array to</span>
<span class="w">    </span><span class="c1">// represent the ragged-right array and set the starting 1D index</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">start_index_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for i</span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// Overloaded constructor with a view c array</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// The length of the stride array is some_dim1;</span>
<span class="w">    </span><span class="n">dim1_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create and initialize the starting index of the entries in the 1D array</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[(</span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span><span class="w"> </span><span class="c1">// note the dim1+1</span>
<span class="w">    </span><span class="n">start_index_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// the 1D array starts at 0</span>

<span class="w">    </span><span class="c1">// Loop over to find the total length of the 1D array to</span>
<span class="w">    </span><span class="c1">// represent the ragged-right array and set the starting 1D index</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">start_index_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for i</span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// Overloaded constructor with a regular cpp array</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="c1">// The length of the stride array is some_dim1;</span>
<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create and initialize the starting index of the entries in the 1D array</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[(</span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span><span class="w"> </span><span class="c1">// note the dim1+1</span>
<span class="w">    </span><span class="n">start_index_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// the 1D array starts at 0</span>

<span class="w">    </span><span class="c1">// Loop over to find the total length of the 1D array to</span>
<span class="w">    </span><span class="c1">// represent the ragged-right array and set the starting 1D index</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="n">start_index_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for i</span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// overloaded constructor for a dynamically built strides_array.</span>
<span class="c1">// buffer is the max number of columns needed</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">buffer</span><span class="p">){</span><span class="w"></span>

<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// create and initialize the starting index of the entries in the 1D array</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[(</span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span><span class="w"> </span><span class="c1">// note the dim1+1</span>
<span class="w">    </span><span class="c1">//start_index_[0] = 0; // the 1D array starts at 0</span>

<span class="w">    </span><span class="n">num_saved_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_dim1</span><span class="o">*</span><span class="n">buffer</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>

<span class="p">}</span><span class="w"> </span><span class="c1">// end constructor</span>

<span class="c1">// Copy constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedRightArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">num_saved_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">num_saved_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">// shared_ptr</span>
<span class="w">        </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// A method to return the stride size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Ensure that i is within bounds</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is greater than dim1_ in RaggedRightArray&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// A method to increase the stride size, in other words,</span>
<span class="c1">// this is used to build the stride array dynamically</span>
<span class="c1">// DO NOT USE with constructors that are given a stride array</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">push_back</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">num_saved_</span><span class="w"> </span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_saved_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overload operator() to access data as array(i,j)</span>
<span class="c1">// where i=[0:N-1], j=[0:stride(i)]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// get the 1D array index</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>

<span class="w">    </span><span class="c1">// asserts</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of dim1 bounds in RaggedRightArray&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="c1">//assert(j &lt; stride(i) &amp;&amp; &quot;j is out of stride bounds in RaggedRightArray&quot;);  // die if &gt;= stride</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">start</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">length_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j+start is out of bounds in RaggedRightArray&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= 1D array length)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">start</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End operator()</span>

<span class="c1">//return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">num_saved_</span><span class="w"> </span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_saved_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//overload = operator</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">num_saved_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">num_saved_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">// shared_ptr</span>
<span class="w">        </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Destructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">RaggedRightArray</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">//----end of RaggedRightArray class definitions----</span>

<span class="c1">//9. RaggedRightArrayofVectors</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">,</span><span class="w"> </span><span class="n">vector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_saved_</span><span class="p">;</span><span class="w"> </span><span class="c1">// the number saved in the 1D array</span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Default constructor</span>
<span class="w">    </span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//--- 3D array access of a ragged right array storing a vector of size vector_dim_ at each (i,j)---</span>

<span class="w">    </span><span class="c1">// Overload constructor for a CArray</span>
<span class="w">    </span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload constructor for a ViewCArray</span>
<span class="w">    </span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">(</span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overloaded constructor for a traditional array</span>
<span class="w">    </span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload constructor for a RaggedRightArray to</span>
<span class="w">    </span><span class="c1">// support a dynamically built stride_array</span>
<span class="w">    </span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Copy constructor</span>
<span class="w">    </span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedRightArrayofVectors</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return the stride size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return the vector dim</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">vector_dim</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to increase the number of column entries, i.e.,</span>
<span class="w">    </span><span class="c1">// the stride size. Used with the constructor for building</span>
<span class="w">    </span><span class="c1">// the stride_array dynamically.</span>
<span class="w">    </span><span class="c1">// DO NOT USE with the constructures with a strides_array</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">push_back</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload operator() to access data as array(i,j)</span>
<span class="w">    </span><span class="c1">// where i=[0:N-1], j=[stride(i)], k=[0,vector_dim_]</span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// method to return total size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return pointer</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//get row starts array</span>
<span class="w">    </span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="nf">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">RaggedRightArrayofVectors</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">RaggedRightArrayofVectors</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Destructor</span>
<span class="w">    </span><span class="o">~</span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">// End of RaggedRightArray</span>

<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="c1">// Overloaded constructor with CArray</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="c1">// The length of the stride array is some_dim1;</span>
<span class="w">    </span><span class="n">dim1_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">vector_dim_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create and initialize the starting index of the entries in the 1D array</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[(</span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span><span class="w"> </span><span class="c1">// note the dim1+1</span>
<span class="w">    </span><span class="n">start_index_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// the 1D array starts at 0</span>

<span class="w">    </span><span class="c1">// Loop over to find the total length of the 1D array to</span>
<span class="w">    </span><span class="c1">// represent the ragged-right array and set the starting 1D index</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">vector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">start_index_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for i</span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// Overloaded constructor with a view c array</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">(</span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// The length of the stride array is some_dim1;</span>
<span class="w">    </span><span class="n">dim1_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">vector_dim_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create and initialize the starting index of the entries in the 1D array</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[(</span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span><span class="w"> </span><span class="c1">// note the dim1+1</span>
<span class="w">    </span><span class="n">start_index_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// the 1D array starts at 0</span>

<span class="w">    </span><span class="c1">// Loop over to find the total length of the 1D array to</span>
<span class="w">    </span><span class="c1">// represent the ragged-right array and set the starting 1D index</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">vector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">start_index_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for i</span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// Overloaded constructor with a regular cpp array</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="c1">// The length of the stride array is some_dim1;</span>
<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">vector_dim_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create and initialize the starting index of the entries in the 1D array</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[(</span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span><span class="w"> </span><span class="c1">// note the dim1+1</span>
<span class="w">    </span><span class="n">start_index_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// the 1D array starts at 0</span>

<span class="w">    </span><span class="c1">// Loop over to find the total length of the 1D array to</span>
<span class="w">    </span><span class="c1">// represent the ragged-right array of vectors and set the starting 1D index</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">vector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">start_index_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for i</span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// overloaded constructor for a dynamically built strides_array.</span>
<span class="c1">// buffer is the max number of columns needed</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">){</span><span class="w"></span>

<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">vector_dim_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// create and initialize the starting index of the entries in the 1D array</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[(</span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span><span class="w"> </span><span class="c1">// note the dim1+1</span>
<span class="w">    </span><span class="c1">//start_index_[0] = 0; // the 1D array starts at 0</span>

<span class="w">    </span><span class="n">num_saved_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_dim1</span><span class="o">*</span><span class="n">buffer</span><span class="o">*</span><span class="n">vector_dim</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">some_dim1</span><span class="o">*</span><span class="n">buffer</span><span class="p">]);</span><span class="w"></span>

<span class="p">}</span><span class="w"> </span><span class="c1">// end constructor</span>

<span class="c1">// Copy constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedRightArrayofVectors</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">vector_dim_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">vector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">num_saved_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">num_saved_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">// shared pointer</span>
<span class="w">        </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// end copy constructor</span>

<span class="c1">// A method to return the stride size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Ensure that i is within bounds</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is greater than dim1_ in RaggedRightArray&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">start_index_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">vector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// A method to increase the stride size, in other words,</span>
<span class="c1">// this is used to build the stride array dynamically</span>
<span class="c1">// DO NOT USE with constructors that are given a stride array</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">push_back</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">num_saved_</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">vector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_saved_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overload operator() to access data as array(i,j,k)</span>
<span class="c1">// where i=[0:N-1], j=[0:stride(i)], k=[0:vector_dim_]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// get the 1D array index</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>

<span class="w">    </span><span class="c1">// asserts</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of dim1 bounds in RaggedRightArray&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="c1">//assert(j &lt; stride(i) &amp;&amp; &quot;j is out of stride bounds in RaggedRightArray&quot;);  // die if &gt;= stride</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="n">vector_dim_</span><span class="o">+</span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">length_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j+start is out of bounds in RaggedRightArray&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= 1D array length)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">j</span><span class="o">*</span><span class="n">vector_dim_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End operator()</span>

<span class="c1">//return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">num_saved_</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">vector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_saved_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//overload = operator</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">vector_dim_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">vector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">num_saved_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">num_saved_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">// shared pointer</span>
<span class="w">        </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Destructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectors</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">RaggedRightArrayofVectors</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">//----end of RaggedRightArrayofVectors class definitions----</span>

<span class="c1">//10. RaggedDownArray</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">RaggedDownArray</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">num_saved_</span><span class="p">;</span><span class="w"> </span><span class="c1">// the number saved in the 1D array</span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">//default constructor</span>
<span class="w">    </span><span class="n">RaggedDownArray</span><span class="p">()</span><span class="w"> </span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//~~~~2D`~~~~</span>
<span class="w">    </span><span class="c1">//overload constructor with CArray</span>
<span class="w">    </span><span class="n">RaggedDownArray</span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//overload with ViewCArray</span>
<span class="w">    </span><span class="n">RaggedDownArray</span><span class="p">(</span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//overload with traditional array</span>
<span class="w">    </span><span class="n">RaggedDownArray</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dome_dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload constructor for a RaggedDownArray to</span>
<span class="w">    </span><span class="c1">// support a dynamically built stride_array</span>
<span class="w">    </span><span class="n">RaggedDownArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">buffer</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Copy constructor</span>
<span class="w">    </span><span class="n">RaggedDownArray</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedDownArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//method to return stride size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to increase the number of column entries, i.e.,</span>
<span class="w">    </span><span class="c1">// the stride size. Used with the constructor for building</span>
<span class="w">    </span><span class="c1">// the stride_array dynamically.</span>
<span class="w">    </span><span class="c1">// DO NOT USE with the constructures with a strides_array</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">push_back</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//overload () operator to access data as array (i,j)</span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// method to return total size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">size</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return pointer</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//get row starts array</span>
<span class="w">    </span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="nf">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//overload = operator</span>
<span class="w">    </span><span class="n">RaggedDownArray</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedDownArray</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//destructor</span>
<span class="w">    </span><span class="o">~</span><span class="n">RaggedDownArray</span><span class="p">();</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">//~~~~~end of RaggedDownArray class declarations~~~~~~~~</span>

<span class="c1">//no dims</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedDownArray</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//overload constructor with CArray</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedDownArray</span><span class="p">(</span><span class="w"> </span><span class="n">CArray</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Length of stride array</span>
<span class="w">    </span><span class="c1">//dim2_ = strides_array.size();</span>

<span class="w">    </span><span class="c1">// Create and initialize startding indices</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[(</span><span class="n">dim2_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span><span class="w"> </span><span class="c1">// note the dim2+1</span>
<span class="w">    </span><span class="n">start_index_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">//1D array starts at 0</span>


<span class="w">    </span><span class="c1">//length of strides</span>
<span class="w">    </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Loop to find total length of 1D array</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">(</span><span class="n">j</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>

<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// Overload constructor with ViewCArray</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedDownArray</span><span class="p">(</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Length of strides</span>
<span class="w">    </span><span class="c1">//dim2_ = strides_array.size();</span>

<span class="w">    </span><span class="c1">//create array for holding start indices</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[(</span><span class="n">dim2_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span><span class="w"> </span><span class="c1">// note the dim2+1</span>
<span class="w">    </span><span class="n">start_index_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Loop over to get total length of 1D array</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">(</span><span class="n">j</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>

<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// Overload constructor with regualar array</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedDownArray</span><span class="p">(</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Length of stride array</span>
<span class="w">    </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create and initialize starting index of entries</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[(</span><span class="n">dim2_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span><span class="w"> </span><span class="c1">// note the dim2+1</span>
<span class="w">    </span><span class="n">start_index_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Loop over to find length of 1D array</span>
<span class="w">    </span><span class="c1">// Represent ragged down array and set 1D index</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">[</span><span class="n">j</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>

<span class="p">}</span><span class="w"> </span><span class="c1">//end construnctor</span>

<span class="c1">// overloaded constructor for a dynamically built strides_array.</span>
<span class="c1">// buffer is the max number of columns needed</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedDownArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">buffer</span><span class="p">){</span><span class="w"></span>

<span class="w">    </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_dim2</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// create and initialize the starting index of the entries in the 1D array</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[(</span><span class="n">dim2_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span><span class="w"> </span><span class="c1">// note the dim2+1</span>
<span class="w">    </span><span class="c1">//start_index_[0] = 0; // the 1D array starts at 0</span>

<span class="w">    </span><span class="n">num_saved_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_dim2</span><span class="o">*</span><span class="n">buffer</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">length_</span><span class="p">]);</span><span class="w"></span>

<span class="p">}</span><span class="w"> </span><span class="c1">// end constructor</span>

<span class="c1">// Copy constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">RaggedDownArray</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedDownArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">num_saved_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">num_saved_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">// shared pointer</span>
<span class="w">        </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// end copy constructor</span>

<span class="c1">// Check the stride size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is greater than dim2_ in RaggedDownArray&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// A method to increase the stride size, in other words,</span>
<span class="c1">// this is used to build the stride array dynamically</span>
<span class="c1">// DO NOT USE with constructors that are given a stride array</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">push_back</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">num_saved_</span><span class="w"> </span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_saved_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// overload operator () to access data as an array(i,j)</span>
<span class="c1">// Note: i = 0:stride(j), j = 0:N-1</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Where is the array starting?</span>
<span class="w">    </span><span class="c1">// look at start index</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="p">];</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Make sure we are within array bounds</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">stride</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in RaggedDownArray&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of dim2_ bounds in RaggedDownArray&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">start</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">length_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i+start is out of bounds in RaggedDownArray&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= 1D array length)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">start</span><span class="p">];</span><span class="w"></span>

<span class="p">}</span><span class="w"> </span><span class="c1">// End () operator</span>

<span class="c1">//overload = operator</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedDownArray</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">num_saved_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">num_saved_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">// shared pointer</span>
<span class="w">        </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Destructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">RaggedDownArray</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="c1">// End destructor</span>


<span class="c1">//----end of RaggedDownArray----</span>


<span class="c1">//11. DynamicRaggedRightArray</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DynamicRaggedRightArray</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Default constructor</span>
<span class="w">    </span><span class="n">DynamicRaggedRightArray</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//--- 2D array access of a ragged right array ---</span>

<span class="w">    </span><span class="c1">// overload constructor</span>
<span class="w">    </span><span class="n">DynamicRaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Copy constructor</span>
<span class="w">    </span><span class="n">DynamicRaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DynamicRaggedRightArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return or set the stride size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return the size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return pointer</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload operator() to access data as array(i,j),</span>
<span class="w">    </span><span class="c1">// where i=[0:N-1], j=[stride(i)]</span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload copy assignment operator</span>
<span class="w">    </span><span class="n">DynamicRaggedRightArray</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DynamicRaggedRightArray</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Destructor</span>
<span class="w">    </span><span class="o">~</span><span class="n">DynamicRaggedRightArray</span><span class="w"> </span><span class="p">();</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">//nothing</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DynamicRaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">DynamicRaggedRightArray</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DynamicRaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">DynamicRaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// The dimensions of the array;</span>
<span class="w">    </span><span class="n">dim1_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dim2_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create memory on the heap for the values</span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="p">]);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create memory for the stride size in each row</span>
<span class="w">    </span><span class="n">stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[</span><span class="n">dim1</span><span class="p">]);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Initialize the stride</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">stride_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Start index is always = j + i*dim2</span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Copy constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DynamicRaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">DynamicRaggedRightArray</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DynamicRaggedRightArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">// shared pointer</span>
<span class="w">        </span><span class="n">stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// end copy constructor</span>

<span class="c1">// A method to set the stride size for row i</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DynamicRaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">stride_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DynamicRaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overload operator() to access data as array(i,j),</span>
<span class="c1">// where i=[0:N-1], j=[0:stride(i)]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DynamicRaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Asserts</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of dim1 bounds in DynamicRaggedRight&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of dim2 bounds in DynamicRaggedRight&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">stride_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of stride bounds in DynamicRaggedRight&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= stride</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="o">*</span><span class="n">dim2_</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//overload = operator</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">DynamicRaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">DynamicRaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DynamicRaggedRightArray</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">// shared pointer</span>
<span class="w">        </span><span class="n">stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DynamicRaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Destructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DynamicRaggedRightArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">DynamicRaggedRightArray</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>




<span class="c1">//----end DynamicRaggedRightArray class definitions----</span>


<span class="c1">//12. DynamicRaggedDownArray</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DynamicRaggedDownArray</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Default constructor</span>
<span class="w">    </span><span class="n">DynamicRaggedDownArray</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//--- 2D array access of a ragged right array ---</span>

<span class="w">    </span><span class="c1">// overload constructor</span>
<span class="w">    </span><span class="n">DynamicRaggedDownArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Copy constructor</span>
<span class="w">    </span><span class="n">DynamicRaggedDownArray</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DynamicRaggedDownArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return or set the stride size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return the size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload operator() to access data as array(i,j),</span>
<span class="w">    </span><span class="c1">// where i=[stride(j)], j=[0:N-1]</span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload copy assignment operator</span>
<span class="w">    </span><span class="n">DynamicRaggedDownArray</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DynamicRaggedDownArray</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return pointer</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Destructor</span>
<span class="w">    </span><span class="o">~</span><span class="n">DynamicRaggedDownArray</span><span class="w"> </span><span class="p">();</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">//nothing</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DynamicRaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">DynamicRaggedDownArray</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DynamicRaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">DynamicRaggedDownArray</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// The dimensions of the array;</span>
<span class="w">    </span><span class="n">dim1_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dim2_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create memory on the heap for the values</span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="p">]);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create memory for the stride size in each row</span>
<span class="w">    </span><span class="n">stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[</span><span class="n">dim2</span><span class="p">]);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Initialize the stride</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="n">dim2_</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">stride_</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Start index is always = i + j*dim1</span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Copy constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DynamicRaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">DynamicRaggedDownArray</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DynamicRaggedDownArray</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">// shared pointer</span>
<span class="w">        </span><span class="n">stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// end copy constructor</span>


<span class="c1">// A method to set the stride size for column j</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DynamicRaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">stride_</span><span class="p">[</span><span class="n">j</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DynamicRaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// overload operator () to access data as an array(i,j)</span>
<span class="c1">// Note: i = 0:stride(j), j = 0:N-1</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DynamicRaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Asserts</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of dim1 bounds in DynamicRaggedDownArray&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of dim2 bounds in DynamicRaggedDownArray&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">stride_</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of stride bounds in DynamicRaggedDownArray&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= stride</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dim1_</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//overload = operator</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">DynamicRaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">DynamicRaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DynamicRaggedDownArray</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="c1">// shared pointer</span>
<span class="w">        </span><span class="n">stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kr">inline</span><span class="w"> </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DynamicRaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Destructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DynamicRaggedDownArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">DynamicRaggedDownArray</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">//----end of DynamicRaggedDownArray class definitions-----</span>


<span class="c1">// 15CSRArrayy</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">CSRArray</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">private</span><span class="o">:</span><span class="w"> </span><span class="c1">// What ought to be private ?</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"> </span><span class="c1">// dim1_ is number of rows dim2_ is number of columns</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">column_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">    </span><span class="n">CSRArray</span><span class="p">();</span><span class="w"></span>


<span class="w">    </span><span class="n">CSRArray</span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">column_index</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">start_index</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CSRArray</span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dense</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CSRArray</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CSRArray</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">value</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">CSRArray</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CSRArray</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="nf">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">printer</span><span class="p">();</span><span class="w"> </span><span class="c1">//debugging tool</span>

<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">begin</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="nf">end</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">dim1</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">dim2</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// iterator for the raw data at row i</span>
<span class="w">    </span><span class="c1">// i.e. return the index each element is the index in the 1 array</span>
<span class="w">    </span><span class="c1">// This as the use of providing a reasonable way to get the column</span>
<span class="w">    </span><span class="c1">// index and data value in the case you need both</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">begin_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">end_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Get number of non zero elements in row i</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">nnz</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Get total number of non zero elements</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">nnz</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// underscore stuff</span>
<span class="w">    </span><span class="c1">// Use the index into the 1d array to get what value is stored there and what is the corresponding row</span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">get_val_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">get_col_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// reverse map function from A(i,j) to what element of data/col_pt_ it corersponds to</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">flat_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Convertor</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">toCSC</span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">start_index</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">row_index</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">to_dense</span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">A</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">//destructor</span>
<span class="w">   </span><span class="o">~</span><span class="n">CSRArray</span><span class="p">();</span><span class="w"></span>


<span class="p">};</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CSRArray</span><span class="p">(){}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CSRArray</span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">column_index</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">start_index</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nnz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[</span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">nnz</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="n">column_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[</span><span class="n">nnz</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nnz</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">column_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">column_index</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">nnz_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nnz</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CSRArray</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">nnz_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">column_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">column_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CSRArray</span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dense</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dense</span><span class="p">.</span><span class="n">dims</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dense</span><span class="p">.</span><span class="n">dims</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">nnz_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dense</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[</span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">nnz_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="n">column_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[</span><span class="n">nnz_</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">cur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="w"></span>
<span class="w">                    </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="n">column_index_</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w"></span>
<span class="w">                    </span><span class="n">array_</span><span class="p">[</span><span class="n">cur</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dense</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">);</span><span class="w"></span>
<span class="w">                    </span><span class="n">cur</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">start_index_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>


<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">row_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">row_start</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">column_index_</span><span class="p">[</span><span class="n">row_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">row_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="p">[</span><span class="n">nnz_</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">nnz_</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">value</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">row_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">row_start</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">column_index_</span><span class="p">[</span><span class="n">row_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">row_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="p">[</span><span class="n">nnz_</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">nnz_</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CSRArray</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">nnz_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">column_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">column_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//debugging tool primarily</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">printer</span><span class="p">(){</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot; %d &quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">));</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">to_dense</span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">A</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">nrows_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Index i out of bounds in CSRArray.stride()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dim1</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dim2</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">begin</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">nrows_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CSRArray.begin()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array_</span><span class="p">[</span><span class="n">row_start</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">end</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">nrows_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CSRArray.end()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array_</span><span class="p">[</span><span class="n">row_start</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">begin_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">nrows_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CSRArray.begin_index()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">end_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">nrows_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CSRArray.begin_index()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">nnz</span><span class="p">(){</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">nnz</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">nrows_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Index i out of bounds in CSRArray.stride()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">get_val_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">){</span><span class="w"></span>
<span class="w">   </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nnz_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Index k is out of bounds in CSRArray.get_val_flat()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">get_col_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nnz_f</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Index k is out of bounds in CSRArray.get_col_lat()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">column_index_</span><span class="p">[</span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">flat_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">row_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">row_start</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">column_index_</span><span class="p">[</span><span class="n">row_start</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">row_start</span><span class="o">+</span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Assumes that data, col_ptrs, and row_ptrs</span>
<span class="c1">// have been allocated size already before this call</span>
<span class="c1">// Returns the data in this csr format but as represented as the appropriatte vectors</span>
<span class="c1">// for a csc format</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">toCSC</span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">col_ptrs</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">row_ptrs</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz_cols</span><span class="p">[</span><span class="n">dim2_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">col_counts</span><span class="p">[</span><span class="n">dim2_</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// How many elements are each column</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">nnz_cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">col_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">nnz_cols</span><span class="p">[</span><span class="n">dim2_</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">col_ptrs</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nnz_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">nnz_cols</span><span class="p">[</span><span class="n">column_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="c1">// What we actually care about is how many elements are</span>
<span class="w">    </span><span class="c1">// in all the  columns preceeding this column.</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">nnz_cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nnz_cols</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nnz_cols</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="n">col_ptrs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nnz_cols</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// if b is at A(i,j)  stored in csr format</span>
<span class="w">    </span><span class="c1">// it needs to go where the where the ith column starts</span>
<span class="w">    </span><span class="c1">// + how many things we have put in the &quot;window&quot;</span>
<span class="w">    </span><span class="c1">// we allocated for this column already</span>
<span class="w">    </span><span class="c1">// For row we simply keep track of what row we are currently in</span>
<span class="w">    </span><span class="c1">// as we scan through the 1d array of data.</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nnz_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">row</span><span class="p">]){</span><span class="w"></span>
<span class="w">            </span><span class="n">row</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nnz_cols</span><span class="p">[</span><span class="n">column_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">col_counts</span><span class="p">[</span><span class="n">column_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span><span class="w"></span>
<span class="w">        </span><span class="n">col_counts</span><span class="p">[</span><span class="n">column_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">data</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="n">row_ptrs</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="c1">// I return an int because I thought I might need to return an error code</span>
<span class="w">    </span><span class="c1">// Not sure that is true</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSRArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">CSRArray</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// EndCSRArrayy</span>

<span class="c1">// 16 CSCArray</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">CSCArray</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"> </span><span class="c1">// What ought to be private ?</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">row_index_</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">      </span><span class="n">CSCArray</span><span class="p">();</span><span class="w"></span>

<span class="w">      </span><span class="n">CSCArray</span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">row_index</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">start_index</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">&amp;</span><span class="nf">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="n">CSCArray</span><span class="w"> </span><span class="o">&amp;</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CSCArray</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="nf">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">&amp;</span><span class="nf">value</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="nf">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">dim1</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">dim2</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="nf">begin</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="nf">end</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="c1">// iterator for the raw data at row i</span>
<span class="w">      </span><span class="c1">// i.e. return the index each element is the index in the 1 array</span>
<span class="w">      </span><span class="c1">// This as the use of providing a reasonable way to get the column</span>
<span class="w">      </span><span class="c1">// index and data value in the case you need both</span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">begin_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">end_index</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">nnz</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">nnz</span><span class="p">();</span><span class="w"></span>

<span class="w">      </span><span class="c1">// Use the index into the 1d array to get what value is stored there and what is the corresponding row</span>
<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">&amp;</span><span class="nf">get_val_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">get_row_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="c1">// reverse map function from A(i,j) to what element of data/col_pt_ it corersponds to</span>
<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="nf">flat_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="c1">// Convertor</span>
<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="nf">toCSR</span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">row_ptrs</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">col_ptrs</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="kt">void</span><span class="w"> </span><span class="nf">to_dense</span><span class="p">(</span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">A</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="c1">// destructor</span>
<span class="w">      </span><span class="o">~</span><span class="n">CSCArray</span><span class="p">();</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">CSCArray</span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">row_index</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">start_index</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nnz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[</span><span class="n">dim2_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T</span><span class="p">[</span><span class="n">nnz</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="n">row_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">size_t</span><span class="p">[</span><span class="n">nnz</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nnz</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">row_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row_index</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">nnz_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nnz</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">col_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">col_start</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">row_index_</span><span class="p">[</span><span class="n">col_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">col_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="p">[</span><span class="n">nnz_</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">nnz_</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">value</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">col_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">col_start</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">row_index_</span><span class="p">[</span><span class="n">col_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">col_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="p">[</span><span class="n">nnz_</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">nnz_</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="n">start_index_</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CSCArray</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">nnz_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;;</span><span class="w"></span>

<span class="w">        </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">row_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">row_row_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CSCArray.stride()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">to_dense</span><span class="p">(</span><span class="n">FArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">A</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dim1</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dim2</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">begin</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;index i out of bounds at CSCArray.begin()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array_</span><span class="p">[</span><span class="n">col_start</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">end</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim2s_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;index i out of bounds at CSCArray.endt()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array_</span><span class="p">[</span><span class="n">col_start</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">begin_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim2s_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;index i out of bounds at CSCArray.begin_index()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">end_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;index i out of bounds at CSCArray.end_index()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">nnz</span><span class="p">(){</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">nnz</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">get_val_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">get_row_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">row_index_</span><span class="p">[</span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">flat_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">col_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">col_start</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">row_index_</span><span class="p">[</span><span class="n">col_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">col_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="mi">-1</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Assumes that data, col_ptrs, and row_ptrs</span>
<span class="c1">// have been allocated size already before this call</span>
<span class="c1">// Returns the data in this csr format but as represented as the appropriatte vectors</span>
<span class="c1">// for a csc format</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">toCSR</span><span class="p">(</span><span class="n">CArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">col_ptrs</span><span class="p">,</span><span class="w"> </span><span class="n">CArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">row_ptrs</span><span class="w"> </span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nnz_rows</span><span class="p">[</span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">row_counts</span><span class="p">[</span><span class="n">dim1_</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// How many elements are each column</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">nnz_rows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">row_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">nnz_rows</span><span class="p">[</span><span class="n">dim1_</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">row_ptrs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nnz_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">nnz_rows</span><span class="p">[</span><span class="n">row_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="c1">// What we actually care about is how many elements are</span>
<span class="w">    </span><span class="c1">// in all the columns preceeding this column.</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">nnz_rows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nnz_rows</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nnz_rows</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="n">row_ptrs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nnz_rows</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// if b is at A(i,j)  stored in csr format</span>
<span class="w">    </span><span class="c1">// it needs to go where the where the ith column starts</span>
<span class="w">    </span><span class="c1">// + how many things we have put in the &quot;window&quot;</span>
<span class="w">    </span><span class="c1">// we allocated for this column already</span>
<span class="w">    </span><span class="c1">// For row we simply keep track of what row we are currently in</span>
<span class="w">    </span><span class="c1">// as we scan through the 1d array of data.</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nnz_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">col</span><span class="p">]){</span><span class="w"></span>
<span class="w">            </span><span class="n">col</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nnz_rows</span><span class="p">[</span><span class="n">row_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">row_counts</span><span class="p">[</span><span class="n">row_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span><span class="w"></span>
<span class="w">        </span><span class="n">row_counts</span><span class="p">[</span><span class="n">row_index_</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">data</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="n">col_ptrs</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="c1">// I return an int because I thought I might need to return an error code</span>
<span class="w">    </span><span class="c1">// Not sure that is true</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSCArray</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">CSCArray</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// End of CSCArray</span>
<span class="c1">//=======================================================================</span>
<span class="c1">//  end of standard MATAR data-types</span>
<span class="c1">//========================================================================</span>

<span class="c1">// #ifdef HAVE_KOKKOS</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">FArrayKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">    </span><span class="n">FArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">sone_dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">sone_dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload operator() to acces data</span>
<span class="w">    </span><span class="c1">// from 1D to 6D</span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload = operator</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">FArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return kokkos view</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">get_kokkos_view</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Destructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">FArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">//end of FArrayKokkos declarations</span>

<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 3D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 4D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 5D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 6D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 7D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Definitions of overload operator()</span>
<span class="c1">// for 1D to 7D</span>
<span class="c1">// Note: the indices for array all start at 0</span>

<span class="c1">// 1D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in FArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in FArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in FArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// 7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in FArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in FArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in FArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overload = operator</span>
<span class="c1">// for object assingment THIS = FArrayKokkos&lt;&gt; TEMP(n,m,,,,)</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;FArrayKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to FArrayKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return the stored Kokkos view</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">get_kokkos_view</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Destructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">FArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">FArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// End of FArrayKokkos</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">ViewFArrayKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">ViewFArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>


<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">ViewFArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// End of ViewFArrayKokkos declarations</span>

<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 3D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 4D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 5D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 6D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 7D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded operator() for 1D array access</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//2D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//3D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//4D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//5D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//6D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//7D</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in ViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;ViewFArrayKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to ViewFArrayKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">ViewFArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// End of ViewFArrayKokkos</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">FMatrixKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">FMatrixKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">FMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return kokkos view</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">get_kokkos_view</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">FMatrixKokkos</span><span class="p">();</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// End of FMatrixKokkos</span>

<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 3D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 4D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 5D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 5D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 5D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">FMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrixKokkos in 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrixKokkos in 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FMatrixKokkos in 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrixKokkos in 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FMatrixKokkos in 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FMatrixKokkos in 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrixKokkos in 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FMatrixKokkos in 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FMatrixKokkos in 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FMatrixKokkos in 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrixKokkos in 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FMatrixKokkos in 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FMatrixKokkos in 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FMatrixKokkos in 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in FMatrixKokkos in 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrixKokkos in 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FMatrixKokkos in 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FMatrixKokkos in 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FMatrixKokkos in 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in FMatrixKokkos in 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in FMatrixKokkos in 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in FMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in FMatrixKokkos in 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in FMatrixKokkos in 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in FMatrixKokkos in 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in FMatrixKokkos in 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in FMatrixKokkos in 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in FMatrixKokkos in 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in FMatrixKokkos in 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">o</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>



<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="o">--</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;FMatrixKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to FMatrixKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return the stored Kokkos view</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">get_kokkos_view</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">FMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">FMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// End of FMatrixKokkos</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">ViewFMatrixKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">ViewFMatrixKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">ViewFMatrixKokkos</span><span class="p">();</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// end of ViewFMatrixKokkos</span>

<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 3D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 4D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 5D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 6D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 6D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in ViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">o</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="o">--</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;ViewFMatrixKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to ViewFMatrixKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">ViewFMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// End of ViewFMatrixKokkos</span>


<span class="c1">// DFArrayKokkos:  Dual type for managing data on both CPU and GPU.</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DFArrayKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// this is manage</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">DualView</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">DFArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">DFArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DFArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DFArrayKokkos</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DFArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DFArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DFArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DFArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">DFArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// GPU Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Host Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw device pointer of the Kokkos DualView</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw host pointer of the Kokkos DualView</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Data member to access host view</span>
<span class="w">    </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">host</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update host view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_host</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update device view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_device</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Deconstructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">DFArrayKokkos</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// End of DFArrayKokkos declarations</span>

<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DFArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DFArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DFArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in DFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">host</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;DFArrayKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to DFArrayKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_host</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">this_array_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">modify</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">execution_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">sync</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">host_mirror_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_device</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">this_array_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">modify</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">host_mirror_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">sync</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">execution_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">DFArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="c1">// End DFArrayKokkos</span>


<span class="c1">// DViewFArrayKokkos:  The DView means dual view of the data, where data is on both CPU and GPU.</span>
<span class="c1">//</span>
<span class="c1">// This MATAR type is for accepting a pointer to data on the CPU via the constructor and then it copies the data</span>
<span class="c1">// data to the GPU where the member functions and overloads access the data on the GPU. The corresponding</span>
<span class="c1">// FArrayKokkos type creates memory on the GPU; likewise, the viewFArrayKokkos accesses data already on the GPU.</span>
<span class="c1">// To emphasize, the data must be on the CPU prior to calling the constructor for the DView data type.</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DViewFArrayKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// this is always unmanaged</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">HostSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryUnmanaged</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// this is manage</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1DHost</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">temp_inp_array_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">DViewFArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">DViewFArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// GPU Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Host Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw device pointer of the Kokkos View</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw host pointer of the Kokkos View</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Data member to access host view</span>
<span class="w">    </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">host</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update host view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_host</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update device view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_device</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Deconstructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">DViewFArrayKokkos</span><span class="w"> </span><span class="p">();</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">// End of DViewFArrayKokkos</span>


<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//using TArray1DHost = Kokkos::View&lt;T*, Layout, HostSpace, MemoryUnmanaged&gt;;</span>
<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T*, Layout, ExecSpace&gt;;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray. Note: inp_array and this_array_host_.data() are the same pointer</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//using TArray1DHost = Kokkos::View&lt;T*, Layout, HostSpace, MemoryUnmanaged&gt;;</span>
<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T*, Layout, ExecSpace&gt;;</span>
<span class="w">    </span><span class="c1">//using TArray1Dtemp = TArray1D::HostMirror;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T*, Layout, ExecSpace&gt;;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T *,Layout,ExecSpace&gt;;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T *,Layout,ExecSpace&gt;;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T *,Layout,ExecSpace&gt;;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T *,Layout,ExecSpace&gt;;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewFArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewFArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewFArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewFArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DViewFArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DViewFArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in DViewFArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">temp_inp_array_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_array_host_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">host</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;DViewFArrayKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to DViewFArrayKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_host</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Deep copy of device view to host view</span>
<span class="w">    </span><span class="n">deep_copy</span><span class="p">(</span><span class="n">this_array_host_</span><span class="p">,</span><span class="w"> </span><span class="n">this_array_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_device</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Deep copy of host view to device view</span>
<span class="w">    </span><span class="n">deep_copy</span><span class="p">(</span><span class="n">this_array_</span><span class="p">,</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DViewFArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">DViewFArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="c1">// End DViewFArrayKokkos</span>


<span class="c1">// DFMatrixKokkos</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DFMatrixKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// this is manage</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">DualView</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">DFMatrixKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">DFMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DFMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DFMatrixKokkos</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DFMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DFMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DFMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DFMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">DFMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// GPU Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Host Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw device pointer of the Kokkos DualView</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw host pointer of the Kokkos DualView</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Data member to access host view</span>
<span class="w">    </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">host</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update host view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_host</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update device view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_device</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Deconstructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">DFMatrixKokkos</span><span class="w"> </span><span class="p">();</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">// End of DFMatrixKokkos declarations</span>

<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DFMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DFMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DFMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DFMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in DFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">o</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">host</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="o">--</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;DFMatrixKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to DFMatrixKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_host</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">this_matrix_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">modify</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">execution_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">sync</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">host_mirror_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_device</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">this_matrix_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">modify</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">host_mirror_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">sync</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">execution_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">DFMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="c1">// End DFMatrixKokkos</span>


<span class="c1">// DViewFMatrixKokkos</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DViewFMatrixKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// this is always unmanaged</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">HostSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryUnmanaged</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// this is manage</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1DHost</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">temp_inp_matrix_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">DViewFMatrixKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">DViewFMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// GPU Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Host Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw device pointer of the Kokkos View</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw host pointer of the Kokkos View</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Data member to access host view</span>
<span class="w">    </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">host</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update host view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_host</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update device view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_device</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Deconstructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">DViewFMatrixKokkos</span><span class="w"> </span><span class="p">();</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">// End of DViewFMatrixKokkos</span>


<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix. Note: inp_matrix and this_matrix_host_.data() are the same pointer</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewFMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewFMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewFMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewFMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewFMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewFMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewFMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DViewFMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DViewFMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in DViewFMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">o</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">temp_inp_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_matrix_host_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">host</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="o">--</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;DViewFMatrixKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to DViewFMatrixKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_host</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Deep copy of device view to host view</span>
<span class="w">    </span><span class="n">deep_copy</span><span class="p">(</span><span class="n">this_matrix_host_</span><span class="p">,</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_device</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Deep copy of host view to device view</span>
<span class="w">    </span><span class="n">deep_copy</span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">,</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DViewFMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">DViewFMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="c1">// End DViewFMatrixKokkos</span>


<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">CArrayKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">CArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">CArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CArrayKokkos</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">CArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// GPU Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Host Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Methods returns the raw pointer (most likely GPU) of the Kokkos View</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return the view</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">get_kokkos_view</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Deconstructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">CArrayKokkos</span><span class="w"> </span><span class="p">();</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">// End of CArrayKokkos</span>

<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in CArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in CArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in CArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in CArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in CArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in CArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;CArrayKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to CArrayKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return the stored Kokkos view</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">get_kokkos_view</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">CArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// End of CArrayKokkos</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">ViewCArrayKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w">  </span><span class="c1">// Length of 1D array</span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">ViewCArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                     </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">ViewCArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// end of ViewCArrayKokkos</span>

<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 3D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 4D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 5D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 6D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 7D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_array</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in ViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in ViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in ViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">[</span><span class="n">o</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;ViewCArrayKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to ViewCArrayKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">ViewCArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// End of ViewCArrayKokkos</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">CMatrixKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">CMatrixKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">CMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return the view</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">get_kokkos_view</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">CMatrixKokkos</span><span class="p">();</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// End of CMatrixKokkos</span>

<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 3D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 4D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 5D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 6D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 7D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in CMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in CMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in CMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in CMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in CMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in CMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in CMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in CMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in CMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in CMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">o</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span><span class="w"></span>
<span class="w">                              </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                              </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                              </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                              </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                              </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overload = operator</span>
<span class="c1">// for object assignment THIS = CMatrixKokkos &lt;&gt; temp</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="o">--</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;CMatrixKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to CMatrixKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return the stored Kokkos view</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">get_kokkos_view</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Deconstructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">CMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">CMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// End of CMatrixKokkos</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">ViewCMatrixKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">ViewCMatrixKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="nf">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">ViewCMatrixKokkos</span><span class="p">();</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// End of ViewCMatrixKokkos</span>

<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrixKokkos</span><span class="p">(){</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 3D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 4D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 5D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 6D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 7D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">ViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                                        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_matrix</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in ViewCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in ViewCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in ViewCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in ViewCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds for ViewCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds for ViewCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds for ViewCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds for ViewCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds for ViewCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds for ViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds for ViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds for ViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds for ViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds for ViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds for ViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in ViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds for ViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds for ViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds for ViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds for ViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds for ViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds for ViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds for ViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">[</span><span class="n">o</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">])];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="o">--</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;ViewCMatrixKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to ViewCMatrixKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">ViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::~</span><span class="n">ViewCMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// End of ViewCMatrixKokkos</span>

<span class="c1">// DCArrayKokkos:  Dual type for managing data on both CPU and GPU.</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DCArrayKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// this is manage</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">DualView</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">DCArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">DCArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DCArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DCArrayKokkos</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DCArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DCArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DCArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DCArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">DCArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// GPU Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Host Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw device pointer of the Kokkos DualView</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw host pointer of the Kokkos DualView</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns kokkos dual view</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">get_kokkos_dual_view</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Data member to access host view</span>
<span class="w">    </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">host</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update host view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_host</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update device view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_device</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Deconstructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">DCArrayKokkos</span><span class="w"> </span><span class="p">();</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">// End of DCArrayKokkos</span>


<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DCArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DCArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DCArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in DCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">host</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;DCArrayKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to DCArrayKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">d_view</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">Kokkos</span><span class="o">::</span><span class="n">DualView</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">get_kokkos_dual_view</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_host</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">this_array_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">modify</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">execution_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">sync</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">host_mirror_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_device</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">this_array_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">modify</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">host_mirror_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">this_array_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">sync</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">execution_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">DCArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="c1">// End DCArrayKokkos</span>


<span class="c1">// DViewCArrayKokkos</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DViewCArrayKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// this is always unmanaged</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">HostSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryUnmanaged</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// this is manage</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1DHost</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">temp_inp_array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">//typename Kokkos::View&lt;T*, Layout, ExecSpace&gt;::HostMirror  h_this_array_;</span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">DViewCArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">DViewCArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// GPU Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Host Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw device pointer of the Kokkos View</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw host pointer of the Kokkos View</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Data member to access host view</span>
<span class="w">    </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">host</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update host view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_host</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update device view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_device</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Deconstructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">DViewCArrayKokkos</span><span class="w"> </span><span class="p">();</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">// End of DViewCArrayKokkos</span>


<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//using TArray1DHost = Kokkos::View&lt;T*, Layout, HostSpace, MemoryUnmanaged&gt;;</span>
<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T*, Layout, ExecSpace&gt;;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray. Note: inp_array and this_array_host_.data() are the same pointer</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//using TArray1DHost = Kokkos::View&lt;T*, Layout, HostSpace, MemoryUnmanaged&gt;;</span>
<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T*, Layout, ExecSpace&gt;;</span>
<span class="w">    </span><span class="c1">//using TArray1Dtemp = TArray1D::HostMirror;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T*, Layout, ExecSpace&gt;;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T *,Layout,ExecSpace&gt;;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T *,Layout,ExecSpace&gt;;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T *,Layout,ExecSpace&gt;;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCArrayKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T *,Layout,ExecSpace&gt;;</span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_array pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_array</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCArray</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCArray</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_array</span><span class="p">,</span><span class="w"> </span><span class="n">dim0</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCArrayKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewCArrayKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewCArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewCArrayKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewCArrayKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DViewCArrayKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DViewCArrayKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in DViewCArrayKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                         </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//using TArray1D = Kokkos::View&lt;T *,Layout,ExecSpace&gt;;</span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">temp_inp_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">temp_inp_array_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_array_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_array_host_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_array_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">host</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;DViewCArrayKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to DViewCArrayKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_host</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Deep copy of device view to host view</span>
<span class="w">    </span><span class="n">deep_copy</span><span class="p">(</span><span class="n">this_array_host_</span><span class="p">,</span><span class="w"> </span><span class="n">this_array_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_device</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Deep copy of host view to device view</span>
<span class="w">    </span><span class="n">deep_copy</span><span class="p">(</span><span class="n">this_array_</span><span class="p">,</span><span class="w"> </span><span class="n">this_array_host_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DViewCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">DViewCArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="c1">// End DViewCArrayKokkos</span>


<span class="c1">// DCMatrixKokkos</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DCMatrixKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// this is manage</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">DualView</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">DCMatrixKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">DCMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DCMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DCMatrixKokkos</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DCMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DCMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DCMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DCMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGMATRIX</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">DCMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// GPU Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Host Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw device pointer of the Kokkos DualView</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw host pointer of the Kokkos DualView</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Data member to access host view</span>
<span class="w">    </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">host</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update host view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_host</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update device view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_device</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Deconstructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">DCMatrixKokkos</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="p">};</span><span class="w"> </span><span class="c1">// End of DCMatrixKokkos declarations</span>

<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DCMatrixKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DCMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DCMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DCMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                       </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in DCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">((</span><span class="n">o</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span><span class="w"></span>
<span class="w">                                     </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                                     </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                     </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                     </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                     </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">host</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="o">--</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;DCMatrixKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to DCMatrixKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">d_view</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">h_view</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_host</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">this_matrix_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">modify</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">execution_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">sync</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">host_mirror_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_device</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">this_matrix_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">modify</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">host_mirror_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="p">.</span><span class="k">template</span><span class="w"> </span><span class="n">sync</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">TArray1D</span><span class="o">::</span><span class="n">execution_space</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">DCMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="c1">// End DCMatrixKokkos</span>


<span class="c1">// DViewCMatrixKokkos</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DViewCMatrixKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// this is always unmanaged</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">HostSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryUnmanaged</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// this is manage</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w">  </span><span class="c1">// tensor order (rank)</span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1DHost</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">temp_inp_matrix_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">DViewCMatrixKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                 </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"></span>
<span class="w">                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">DViewCMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// GPU Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Host Method</span>
<span class="w">    </span><span class="c1">// Method that returns size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw device pointer of the Kokkos View</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method returns the raw host pointer of the Kokkos View</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Data member to access host view</span>
<span class="w">    </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">host</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update host view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_host</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Method that update device view</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">update_device</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Deconstructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">DViewCMatrixKokkos</span><span class="w"> </span><span class="p">();</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">// End of DViewCMatrixKokkos</span>


<span class="c1">// Default constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded 1D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix. Note: inp_matrix and this_matrix_host_.data() are the same pointer</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overloaded 2D constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="n">dim6</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DViewCMatrixKokkos</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"></span>
<span class="w">                              </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim7</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim5</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim6</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dim1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a 1D host view of the external allocation</span>
<span class="w">    </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1DHost</span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Assign temp point to inp_matrix pointer that is passed in</span>
<span class="w">    </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inp_matrix</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a device copy of that host view</span>
<span class="w">    </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_mirror_view_and_copy</span><span class="p">(</span><span class="n">ExecSpace</span><span class="p">(),</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create host ViewCMatrix</span>
<span class="w">    </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewCMatrix</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">inp_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="n">dim3</span><span class="p">,</span><span class="w"> </span><span class="n">dim4</span><span class="p">,</span><span class="w"> </span><span class="n">dim5</span><span class="p">,</span><span class="w"> </span><span class="n">dim6</span><span class="p">,</span><span class="w"> </span><span class="n">dim7</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCMatrixKokkos 1D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewCMatrixKokkos 2D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewCMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewCMatrixKokkos 3D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewCMatrixKokkos 4D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DViewCMatrixKokkos 5D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DViewCMatrixKokkos 6D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                                </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"></span>
<span class="w">                               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">o</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">order_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Tensor order (rank) does not match constructor in DViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in DViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of bounds in DViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of bounds in DViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;l is out of bounds in DViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;m is out of bounds in DViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;n is out of bounds in DViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;o is out of bounds in DViewCMatrixKokkos 7D!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">(</span><span class="n">o</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="w">                          </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Do nothing if the assignment is of the form x = x</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"> </span><span class="n">iter</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dims_</span><span class="p">[</span><span class="n">iter</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="c1">// end for</span>

<span class="w">        </span><span class="n">order_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">temp_inp_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">temp_inp_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_matrix_host_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_matrix_host_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">this_matrix_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">this_matrix_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">host</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">extent</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dims</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">i</span><span class="o">--</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">order_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;DViewCMatrixKokkos order (rank) does not match constructor, dim[i] does not exist!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Access to DViewCMatrixKokkos dims is out of bounds!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dims_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">order</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">order_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">device_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">host_pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_host</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Deep copy of device view to host view</span>
<span class="w">    </span><span class="n">deep_copy</span><span class="p">(</span><span class="n">this_matrix_host_</span><span class="p">,</span><span class="w"> </span><span class="n">this_matrix_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">update_device</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Deep copy of host view to device view</span>
<span class="w">    </span><span class="n">deep_copy</span><span class="p">(</span><span class="n">this_matrix_</span><span class="p">,</span><span class="w"> </span><span class="n">this_matrix_host_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DViewCMatrixKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">DViewCMatrixKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="c1">// End DViewCMatrixKokkos</span>


<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Layout</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">RaggedRightArrayKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">SArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">Strides1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">ILayout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Default constructor</span>
<span class="w">    </span><span class="n">RaggedRightArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//--- 2D array access of a ragged right array ---</span>

<span class="w">    </span><span class="c1">// Overload constructor for a CArrayKokkos</span>
<span class="w">    </span><span class="n">RaggedRightArrayKokkos</span><span class="p">(</span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="n">ILayout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload constructor for a DCArrayKokkos</span>
<span class="w">    </span><span class="n">RaggedRightArrayKokkos</span><span class="p">(</span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="n">ILayout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload constructor for a ViewCArray</span>
<span class="w">    </span><span class="n">RaggedRightArrayKokkos</span><span class="p">(</span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overloaded constructor for a traditional array</span>
<span class="w">    </span><span class="n">RaggedRightArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return the stride size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Host method to return the stride size</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">stride_host</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to increase the number of column entries, i.e.,</span>
<span class="w">    </span><span class="c1">// the stride size. Used with the constructor for building</span>
<span class="w">    </span><span class="c1">// the stride_array dynamically.</span>
<span class="w">    </span><span class="c1">// DO NOT USE with the constructures with a strides_array</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="n">build_stride</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">stride_finalize</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload operator() to access data as array(i,j)</span>
<span class="w">    </span><span class="c1">// where i=[0:N-1], j=[stride(i)]</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// method to return total size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">(){</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">//setup start indices</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">data_setup</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return the view</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Kokkos views of strides and start indices</span>
<span class="w">    </span><span class="n">Strides1D</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">RaggedRightArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedRightArrayKokkos</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//initialize start indices view</span>
<span class="w">    </span><span class="k">class</span> <span class="nc">init_start_indices_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">      </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">mystart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="n">init_start_indices_functor</span><span class="p">(</span><span class="n">SArray1D</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">mystart_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">mystart_index_</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">//setup start indices view</span>
<span class="w">    </span><span class="k">class</span> <span class="nc">setup_start_indices_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">mystart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">Strides1D</span><span class="w"> </span><span class="n">mytemp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">setup_start_indices_functor</span><span class="p">(</span><span class="n">SArray1D</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">,</span><span class="w"> </span><span class="n">Strides1D</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">){</span><span class="w"></span>
<span class="w">          </span><span class="n">mystart_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="n">mytemp_strides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="c1">// Load old value in case we update it before accumulating</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mytemp_strides_</span><span class="p">(</span><span class="n">index</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">mystart_index_</span><span class="p">((</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">//setup length of view</span>
<span class="w">    </span><span class="k">class</span> <span class="nc">setup_length_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="c1">//kokkos needs this typedef named</span>
<span class="w">        </span><span class="k">typedef</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">value_type</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="c1">// This is helpful for determining the right index type,</span>
<span class="w">        </span><span class="c1">// especially if you expect to need a 64-bit index.</span>
<span class="w">        </span><span class="c1">//typedef Kokkos::View&lt;size_t*&gt;::size_type size_type;</span>
<span class="w">        </span><span class="n">Strides1D</span><span class="w"> </span><span class="n">mytemp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">setup_length_functor</span><span class="p">(</span><span class="n">Strides1D</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">){</span><span class="w"></span>
<span class="w">          </span><span class="n">mytemp_strides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">//const size_t count = mytemp_strides_(index);</span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">mytemp_strides_</span><span class="p">(</span><span class="n">index</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">//sets final 1D array size</span>
<span class="w">    </span><span class="k">class</span> <span class="nc">finalize_stride_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">mystart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">finalize_stride_functor</span><span class="p">(</span><span class="n">SArray1D</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">){</span><span class="w"></span>
<span class="w">          </span><span class="n">mystart_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="c1">// Load old value in case we update it before accumulating</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mystart_index_</span><span class="p">(</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">mystart_index_</span><span class="p">((</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Destructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">RaggedRightArrayKokkos</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">// End of RaggedRightArray</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayKokkos</span><span class="p">(</span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="n">ILayout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                                        </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">mystrides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">.</span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">.</span><span class="n">extent</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">data_setup</span><span class="p">(</span><span class="n">tag_string</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayKokkos</span><span class="p">(</span><span class="n">DCArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="n">ILayout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                                        </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">mystrides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">.</span><span class="n">get_kokkos_dual_view</span><span class="p">().</span><span class="n">d_view</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">.</span><span class="n">extent</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">data_setup</span><span class="p">(</span><span class="n">tag_string</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayKokkos</span><span class="p">(</span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                                         </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">strides_array</span><span class="p">,</span><span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                                        </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">mystrides_</span><span class="p">.</span><span class="n">assign_data</span><span class="p">(</span><span class="n">strides_array</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">data_setup</span><span class="p">(</span><span class="n">tag_string</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">//setup start indices</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">data_setup</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//allocate start indices</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">append_indices_string</span><span class="p">(</span><span class="s">&quot;start_indices&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">append_array_string</span><span class="p">(</span><span class="s">&quot;array&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tag_string</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">start_index_tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">append_indices_string</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">temp_copy_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tag_string</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">array_tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">append_array_string</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SArray1D</span><span class="p">(</span><span class="n">start_index_tag_string</span><span class="p">,</span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_for</span><span class="p">(</span><span class="s">&quot;StartValuesInit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">start_index_</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">init_start_indices_functor</span><span class="w"> </span><span class="nf">execution_functor</span><span class="p">(</span><span class="n">start_index_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_for</span><span class="p">(</span><span class="s">&quot;StartValuesInit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">execution_functor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>

<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_scan</span><span class="p">(</span><span class="s">&quot;StartValuesSetup&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Load old value in case we update it before accumulating</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">start_index_</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">setup_start_indices_functor</span><span class="w"> </span><span class="nf">setup_execution_functor</span><span class="p">(</span><span class="n">start_index_</span><span class="p">,</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_scan</span><span class="p">(</span><span class="s">&quot;StartValuesSetup&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="n">setup_execution_functor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>

<span class="w">    </span><span class="c1">//compute length of the storage</span>
<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_reduce</span><span class="p">(</span><span class="s">&quot;LengthSetup&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Load old value in case we update it before accumulating</span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">setup_length_functor</span><span class="w"> </span><span class="nf">length_functor</span><span class="p">(</span><span class="n">mystrides_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_reduce</span><span class="p">(</span><span class="s">&quot;LengthSetup&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">length_functor</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>

<span class="w">    </span><span class="c1">//allocate view</span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">array_tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// A method to return the stride size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Ensure that i is within bounds</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">dim1_</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is greater than dim1_ in RaggedRightArray&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Method to build the stride (non-Kokkos push back)</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">build_stride</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Method to finalize stride</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">stride_finalize</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_scan</span><span class="p">(</span><span class="s">&quot;StartValues&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Load old value in case we update it before accumulating</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">start_index_</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">finalize_stride_functor</span><span class="w"> </span><span class="nf">execution_functor</span><span class="p">(</span><span class="n">start_index_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_scan</span><span class="p">(</span><span class="s">&quot;StartValues&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="n">execution_functor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">fence</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="c1">// Overload operator() to access data as array(i,j)</span>
<span class="c1">// where i=[0:N-1], j=[0:stride(i)]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Get the 1D array index</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// asserts</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of dim1 bounds in RaggedRightArrayKokkos&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">stride</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of stride bounds in RaggedRightArrayKokkos&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= stride</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">start</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End operator()</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="w"></span>
<span class="w">  </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="cm">/*</span>
<span class="cm">    SArray1D tempdim = SArray1D(&quot;tempdim&quot;, 1);</span>
<span class="cm">    auto h_tempdim = HostMirror(tempdim);</span>
<span class="cm">    Kokkos::parallel_for(&quot;StrideDim&quot;, 1, KOKKOS_CLASS_LAMBDA(const int&amp;) {</span>
<span class="cm">            tempdim(0)  = strides_array.size();</span>
<span class="cm">            //dim1_  = strides_array.size();</span>
<span class="cm">        });</span>
<span class="cm">    Kokkos::fence();</span>
<span class="cm">    deep_copy(h_tempdim, tempdim);</span>
<span class="cm">    dim1_ = h_tempdim(0);</span>
<span class="cm">    */</span><span class="w"></span>
<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create and initialize the starting index of the entries in the 1D array</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">//start_index_(0) = 0; // the 1D array starts at 0</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">    size_t * h_start_index = new size_t [dim1_+1];</span>
<span class="cm">    h_start_index[0] = 0;</span>
<span class="cm">    size_t * herenow = new size_t [2];</span>
<span class="cm">    herenow[0] = 1;</span>
<span class="cm">    herenow[1] = 2;</span>
<span class="cm">    size_t count = 0;</span>
<span class="cm">    for (size_t i = 0; i &lt; dim1_; i++){</span>
<span class="cm">        count += herenow[i];</span>
<span class="cm">        h_start_index[(i + 1)] = count;</span>
<span class="cm">        printf(&quot;%d) Start check %ld\n&quot;, i, h_start_index[i]);</span>
<span class="cm">    } // end for i</span>
<span class="cm">    */</span><span class="w"></span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">    SArray1D templen = SArray1D(&quot;templen&quot;, 1);</span>
<span class="cm">    auto h_templen = Kokkos::create_mirror_view(templen);</span>
<span class="cm">    #ifdef HAVE_CLASS_LAMBDA</span>
<span class="cm">    Kokkos::parallel_for(&quot;ArrayLength&quot;, 1, KOKKOS_CLASS_LAMBDA(const int&amp;) {</span>
<span class="cm">            templen(0) = start_index_(dim1_);</span>
<span class="cm">            //length_ = start_index_(dim1_);</span>
<span class="cm">        });</span>
<span class="cm">    #else</span>
<span class="cm">    templen_functor templen_execution_functor(templen);</span>
<span class="cm">    Kokkos::parallel_for(&quot;ArrayLength&quot;, 1, templen_execution_functor);</span>
<span class="cm">    #endif</span>
<span class="cm">    Kokkos::fence();</span>
<span class="cm">    Kokkos::deep_copy(h_templen, templen);</span>
<span class="cm">    if (h_templen(0) != 0)</span>
<span class="cm">        length_ = h_templen(0);</span>
<span class="cm">    else</span>
<span class="cm">    */</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>


<span class="w">    </span><span class="c1">//printf(&quot;Length %ld\n&quot;, length_);</span>

<span class="w">    </span><span class="c1">//Kokkos::parallel_for(&quot;StartCheck&quot;, dim1_+1, KOKKOS_CLASS_LAMBDA(const int i) {</span>
<span class="w">    </span><span class="c1">//        printf(&quot;%d) Start %ld\n&quot;, i, start_index_(i));</span>
<span class="w">    </span><span class="c1">//    });</span>
<span class="w">    </span><span class="c1">//Kokkos::fence();</span>

<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mystrides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">mystrides_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">        dim1_ = temp.dim1_;</span>
<span class="cm">        length_ = temp.length_;</span>
<span class="cm">        start_index_ = SArray1D(&quot;start_index_&quot;, dim1_ + 1);</span>
<span class="cm">        Kokkos::parallel_for(&quot;EqualOperator&quot;, dim1_+1, KOKKOS_CLASS_LAMBDA(const int j) {</span>
<span class="cm">                start_index_(j) = temp.start_index_(j);</span>
<span class="cm">            });</span>
<span class="cm">        //for (int j = 0; j &lt; dim1_; j++) {</span>
<span class="cm">        //    start_index_(j) = temp.start_index_(j);</span>
<span class="cm">        //}</span>
<span class="cm">        array_ = TArray1D(&quot;array_&quot;, length_);</span>
<span class="cm">    */</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return the stored Kokkos view</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">get_kokkos_view</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Destructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">RaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::~</span><span class="n">RaggedRightArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="c1">// End of RaggedRightArrayKokkos</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Layout</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">RaggedRightArrayofVectorsKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">SArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">Strides1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">ILayout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">vector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Default constructor</span>
<span class="w">    </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//--- 2D array access of a ragged right array ---</span>

<span class="w">    </span><span class="c1">// Overload constructor for a CArrayKokkos</span>
<span class="w">    </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="p">(</span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="n">ILayout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">,</span><span class="w"></span>
<span class="w">                                    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload constructor for a ViewCArray</span>
<span class="w">    </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="p">(</span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overloaded constructor for a traditional array</span>
<span class="w">    </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return the stride size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to increase the number of column entries, i.e.,</span>
<span class="w">    </span><span class="c1">// the stride size. Used with the constructor for building</span>
<span class="w">    </span><span class="c1">// the stride_array dynamically.</span>
<span class="w">    </span><span class="c1">// DO NOT USE with the constructures with a strides_array</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="n">build_stride</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">stride_finalize</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload operator() to access data as array(i,j)</span>
<span class="w">    </span><span class="c1">// where i=[0:N-1], j=[stride(i)]</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// method to return total size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">(){</span><span class="w"></span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="c1">//setup start indices</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">data_setup</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return the view</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Kokkos views of strides and start indices</span>
<span class="w">    </span><span class="n">Strides1D</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//functors for kokkos execution policies</span>
<span class="w">    </span><span class="c1">// initialize start indices view</span>
<span class="w">    </span><span class="k">class</span> <span class="nc">init_start_indices_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">      </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">mystart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="n">init_start_indices_functor</span><span class="p">(</span><span class="n">SArray1D</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">mystart_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">mystart_index_</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">//setup start indices view</span>
<span class="w">    </span><span class="k">class</span> <span class="nc">setup_start_indices_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">mystart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">Strides1D</span><span class="w"> </span><span class="n">mytemp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">myvector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">setup_start_indices_functor</span><span class="p">(</span><span class="n">SArray1D</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">,</span><span class="w"> </span><span class="n">Strides1D</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">myvector_dim</span><span class="p">){</span><span class="w"></span>
<span class="w">          </span><span class="n">mystart_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="n">mytemp_strides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="n">myvector_dim_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myvector_dim</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="c1">// Load old value in case we update it before accumulating</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mytemp_strides_</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="n">myvector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">mystart_index_</span><span class="p">((</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">//setup length of view</span>
<span class="w">    </span><span class="k">class</span> <span class="nc">setup_length_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="c1">//kokkos needs this typedef named</span>
<span class="w">        </span><span class="k">typedef</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">value_type</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="c1">// This is helpful for determining the right index type,</span>
<span class="w">        </span><span class="c1">// especially if you expect to need a 64-bit index.</span>
<span class="w">        </span><span class="c1">//typedef Kokkos::View&lt;size_t*&gt;::size_type size_type;</span>

<span class="w">        </span><span class="n">Strides1D</span><span class="w"> </span><span class="n">mytemp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">myvector_dim_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="n">setup_length_functor</span><span class="p">(</span><span class="n">Strides1D</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">myvector_dim</span><span class="p">){</span><span class="w"></span>
<span class="w">          </span><span class="n">mytemp_strides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="n">myvector_dim_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myvector_dim</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">//const size_t count = mytemp_strides_(index)*myvector_dim_;</span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">mytemp_strides_</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">*</span><span class="n">myvector_dim_</span><span class="p">;;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">//sets final 1D array size</span>
<span class="w">    </span><span class="k">class</span> <span class="nc">finalize_stride_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">mystart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">finalize_stride_functor</span><span class="p">(</span><span class="n">SArray1D</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">){</span><span class="w"></span>
<span class="w">          </span><span class="n">mystart_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="c1">// Load old value in case we update it before accumulating</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mystart_index_</span><span class="p">(</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">mystart_index_</span><span class="p">((</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Destructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">// End of RaggedRightArrayofVectorsKokkos</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="p">(</span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="n">ILayout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="w">                                                                                                          </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                                                          </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//mystrides_.assign_data(strides_array.pointer());</span>
<span class="w">    </span><span class="n">vector_dim_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mystrides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">.</span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">.</span><span class="n">extent</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">data_setup</span><span class="p">(</span><span class="n">tag_string</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="cm">/*</span>
<span class="cm">template &lt;typename T, typename Layout, typename ExecSpace, typename MemoryTraits, typename ILayout&gt;</span>
<span class="cm">RaggedRightArrayofVectorsKokkos&lt;T,Layout,ExecSpace,MemoryTraits&gt;::RaggedRightArrayofVectorsKokkos(CArrayKokkos&lt;size_t,Kokkos::LayoutLeft,ExecSpace,MemoryTraits&gt;</span>
<span class="cm">                                                                                                  &amp;strides_array, size_t vector_dim) {</span>
<span class="cm">    //mystrides_.assign_data(strides_array.pointer());</span>
<span class="cm">    vector_dim_ = vector_dim;</span>
<span class="cm">    mystrides_ = strides_array;</span>
<span class="cm">    dim1_ = strides_array.extent();</span>
<span class="cm">} // End constructor</span>
<span class="cm">*/</span><span class="w"></span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="p">(</span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                                                          </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                                                          </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">vector_dim_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vector_dim</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mystrides_</span><span class="p">.</span><span class="n">assign_data</span><span class="p">(</span><span class="n">strides_array</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">data_setup</span><span class="p">(</span><span class="n">tag_string</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">//setup start indices</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">data_setup</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="c1">//allocate start indices</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">append_indices_string</span><span class="p">(</span><span class="s">&quot;start_indices&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">append_array_string</span><span class="p">(</span><span class="s">&quot;array&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tag_string</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">start_index_tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">append_indices_string</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">temp_copy_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tag_string</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">array_tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">append_array_string</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SArray1D</span><span class="p">(</span><span class="n">start_index_tag_string</span><span class="p">,</span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_for</span><span class="p">(</span><span class="s">&quot;StartValuesInit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">start_index_</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">init_start_indices_functor</span><span class="w"> </span><span class="nf">execution_functor</span><span class="p">(</span><span class="n">start_index_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_for</span><span class="p">(</span><span class="s">&quot;StartValuesInit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">execution_functor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>

<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_scan</span><span class="p">(</span><span class="s">&quot;StartValuesSetup&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Load old value in case we update it before accumulating</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">vector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">start_index_</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">setup_start_indices_functor</span><span class="w"> </span><span class="nf">setup_execution_functor</span><span class="p">(</span><span class="n">start_index_</span><span class="p">,</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">,</span><span class="w"> </span><span class="n">vector_dim_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_scan</span><span class="p">(</span><span class="s">&quot;StartValuesSetup&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="n">setup_execution_functor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>

<span class="w">    </span><span class="c1">//compute length of the storage</span>
<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_reduce</span><span class="p">(</span><span class="s">&quot;LengthSetup&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Load old value in case we update it before accumulating</span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">vector_dim_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">setup_length_functor</span><span class="w"> </span><span class="nf">length_functor</span><span class="p">(</span><span class="n">mystrides_</span><span class="p">,</span><span class="w"> </span><span class="n">vector_dim_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_reduce</span><span class="p">(</span><span class="s">&quot;LengthSetup&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">length_functor</span><span class="p">,</span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>

<span class="w">    </span><span class="c1">//allocate view</span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">array_tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// A method to return the stride size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Ensure that i is within bounds</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">dim1_</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is greater than dim1_ in RaggedRightArray&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Method to build the stride (non-Kokkos push back)</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">build_stride</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Method to finalize stride</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">stride_finalize</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_scan</span><span class="p">(</span><span class="s">&quot;StartValues&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Load old value in case we update it before accumulating</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">start_index_</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">finalize_stride_functor</span><span class="w"> </span><span class="nf">execution_functor</span><span class="p">(</span><span class="n">start_index_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_scan</span><span class="p">(</span><span class="s">&quot;StartValues&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="n">execution_functor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">fence</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="c1">// Overload operator() to access data as array(i,j)</span>
<span class="c1">// where i=[0:N-1], j=[0:stride(i)]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Get the 1D array index</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// asserts</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of dim1 bounds in RaggedRightArrayKokkos&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">stride</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of stride bounds in RaggedRightArrayKokkos&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= stride</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">vector_dim_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;k is out of vector_dim bounds in RaggedRightArrayKokkos&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= vector_dim</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="n">vector_dim_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End operator()</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="w"></span>
<span class="w">  </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">vector_dim_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">vector_dim_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create and initialize the starting index of the entries in the 1D array</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mystrides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">mystrides_</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return the stored Kokkos view</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">get_kokkos_view</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Destructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">RaggedRightArrayofVectorsKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::~</span><span class="n">RaggedRightArrayofVectorsKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="c1">// End of RaggedRightArrayofVectorsKokkos</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Layout</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">RaggedDownArrayKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">SArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">Strides1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">ILayout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Default constructor</span>
<span class="w">    </span><span class="n">RaggedDownArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//--- 2D array access of a ragged right array ---</span>

<span class="w">    </span><span class="c1">// Overload constructor for a CArray</span>
<span class="w">    </span><span class="n">RaggedDownArrayKokkos</span><span class="p">(</span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload constructor for a ViewCArray</span>
<span class="w">    </span><span class="n">RaggedDownArrayKokkos</span><span class="p">(</span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overloaded constructor for a traditional array</span>
<span class="w">    </span><span class="n">RaggedDownArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return the stride size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//setup start indices</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">data_setup</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload operator() to access data as array(i,j)</span>
<span class="w">    </span><span class="c1">// where i=[0:N-1], j=[stride(i)]</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return the view</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">RaggedDownArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedDownArrayKokkos</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Kokkos views of strides and start indices</span>
<span class="w">    </span><span class="n">Strides1D</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//functors for kokkos execution policies</span>
<span class="w">    </span><span class="c1">//initialize start indices view</span>
<span class="w">    </span><span class="k">class</span> <span class="nc">init_start_indices_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">      </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">mystart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="n">init_start_indices_functor</span><span class="p">(</span><span class="n">SArray1D</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">mystart_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">mystart_index_</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">//setup start indices view</span>
<span class="w">    </span><span class="k">class</span> <span class="nc">setup_start_indices_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">mystart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">Strides1D</span><span class="w"> </span><span class="n">mytemp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">setup_start_indices_functor</span><span class="p">(</span><span class="n">SArray1D</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">,</span><span class="w"> </span><span class="n">Strides1D</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">){</span><span class="w"></span>
<span class="w">          </span><span class="n">mystart_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">          </span><span class="n">mytemp_strides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="c1">// Load old value in case we update it before accumulating</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mytemp_strides_</span><span class="p">(</span><span class="n">index</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">mystart_index_</span><span class="p">((</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">//setup length of view</span>
<span class="w">    </span><span class="k">class</span> <span class="nc">setup_length_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">        </span><span class="c1">//kokkos needs this typedef named</span>
<span class="w">        </span><span class="k">typedef</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">value_type</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="c1">// This is helpful for determining the right index type,</span>
<span class="w">        </span><span class="c1">// especially if you expect to need a 64-bit index.</span>
<span class="w">        </span><span class="c1">//typedef Kokkos::View&lt;size_t*&gt;::size_type size_type;</span>
<span class="w">        </span><span class="n">Strides1D</span><span class="w"> </span><span class="n">mytemp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">setup_length_functor</span><span class="p">(</span><span class="n">Strides1D</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">){</span><span class="w"></span>
<span class="w">          </span><span class="n">mytemp_strides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">//const size_t count = mytemp_strides_(index);</span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">mytemp_strides_</span><span class="p">(</span><span class="n">index</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Destructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">RaggedDownArrayKokkos</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="p">};</span><span class="w"> </span><span class="c1">// End of RaggedDownArray</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">RaggedDownArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">RaggedDownArrayKokkos</span><span class="p">(</span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                              </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">mystrides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">.</span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strides_array</span><span class="p">.</span><span class="n">extent</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">data_setup</span><span class="p">(</span><span class="n">tag_string</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">RaggedDownArrayKokkos</span><span class="p">(</span><span class="n">ViewCArray</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">RaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">RaggedDownArrayKokkos</span><span class="p">(</span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">strides_array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">some_dim2</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                                              </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">mystrides_</span><span class="p">.</span><span class="n">assign_data</span><span class="p">(</span><span class="n">strides_array</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">some_dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">data_setup</span><span class="p">(</span><span class="n">tag_string</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End constructor</span>


<span class="c1">//setup start indices</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">RaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">data_setup</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//allocate start indices</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">append_indices_string</span><span class="p">(</span><span class="s">&quot;start_indices&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">append_array_string</span><span class="p">(</span><span class="s">&quot;array&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tag_string</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">start_index_tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">append_indices_string</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">temp_copy_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tag_string</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">array_tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">append_array_string</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SArray1D</span><span class="p">(</span><span class="n">start_index_tag_string</span><span class="p">,</span><span class="n">dim2_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_for</span><span class="p">(</span><span class="s">&quot;StartValuesInit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim2_</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">start_index_</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">init_start_indices_functor</span><span class="w"> </span><span class="nf">execution_functor</span><span class="p">(</span><span class="n">start_index_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_for</span><span class="p">(</span><span class="s">&quot;StartValuesInit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim2_</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">execution_functor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>

<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_scan</span><span class="p">(</span><span class="s">&quot;StartValuesSetup&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim2_</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Load old value in case we update it before accumulating</span>
<span class="w">            </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">final</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="n">start_index_</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">update</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">setup_start_indices_functor</span><span class="w"> </span><span class="nf">setup_execution_functor</span><span class="p">(</span><span class="n">start_index_</span><span class="p">,</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_scan</span><span class="p">(</span><span class="s">&quot;StartValuesSetup&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim2_</span><span class="p">,</span><span class="n">setup_execution_functor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>

<span class="w">    </span><span class="c1">//compute length of the storage</span>
<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_reduce</span><span class="p">(</span><span class="s">&quot;LengthSetup&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim2_</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">&amp;</span><span class="w"> </span><span class="n">update</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Load old value in case we update it before accumulating</span>
<span class="w">            </span><span class="n">update</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">setup_length_functor</span><span class="w"> </span><span class="nf">length_functor</span><span class="p">(</span><span class="n">mystrides_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_reduce</span><span class="p">(</span><span class="s">&quot;LengthSetup&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim2_</span><span class="p">,</span><span class="w"> </span><span class="n">length_functor</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>

<span class="w">    </span><span class="c1">//allocate view</span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">array_tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// A method to return the stride size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">RaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Ensure that j is within bounds</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">dim2_</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is greater than dim1_ in RaggedDownArray&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">mystrides_</span><span class="p">(</span><span class="n">j</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overload operator() to access data as array(i,j)</span>
<span class="c1">// where i=[0:N-1], j=[0:stride(i)]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">RaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Get the 1D array index</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">(</span><span class="n">j</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// asserts</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">stride</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of stride bounds in RaggedDownArrayKokkos&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= stride</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of dim1 bounds in RaggedDownArrayKokkos&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">start</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="c1">// End operator()</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">RaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">RaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="w"></span>
<span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">RaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="cm">/*</span>
<span class="cm">    SArray1D tempdim = SArray1D(&quot;tempdim&quot;, 1);</span>
<span class="cm">    auto h_tempdim = HostMirror(tempdim);</span>
<span class="cm">    Kokkos::parallel_for(&quot;StrideDim&quot;, 1, KOKKOS_CLASS_LAMBDA(const int&amp;) {</span>
<span class="cm">            tempdim(0)  = strides_array.size();</span>
<span class="cm">            //dim1_  = strides_array.size();</span>
<span class="cm">        });</span>
<span class="cm">    Kokkos::fence();</span>
<span class="cm">    deep_copy(h_tempdim, tempdim);</span>
<span class="cm">    dim1_ = h_tempdim(0);</span>
<span class="cm">    */</span><span class="w"></span>
<span class="w">    </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Create and initialize the starting index of the entries in the 1D array</span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">    //start_index_(0) = 0; // the 1D array starts at 0</span>
<span class="cm">    #ifdef HAVE_CLASS_LAMBDA</span>
<span class="cm">    Kokkos::parallel_for(&quot;StartFirst&quot;, 1, KOKKOS_CLASS_LAMBDA(const int&amp;) {</span>
<span class="cm">            start_index_(0) = 0;</span>
<span class="cm">        });</span>
<span class="cm">    #else</span>
<span class="cm">    assignment_init_functor init_execution_functor;</span>
<span class="cm">    Kokkos::parallel_for(&quot;StartFirst&quot;, 1, init_execution_functor);</span>
<span class="cm">    #endif</span>
<span class="cm">    Kokkos::fence();</span>

<span class="cm">    // Loop over to find the total length of the 1D array to</span>
<span class="cm">    // represent the ragged-right array and set the starting 1D index</span>
<span class="cm">    #ifdef HAVE_CLASS_LAMBDA</span>
<span class="cm">    Kokkos::parallel_scan(&quot;StartValues&quot;, dim2_, KOKKOS_CLASS_LAMBDA(const int j, double&amp; update, const bool final) {</span>
<span class="cm">            // Load old value in case we update it before accumulating</span>
<span class="cm">            const size_t count = temp.mystrides_[j];</span>
<span class="cm">            update += count;</span>
<span class="cm">            if (final) {</span>
<span class="cm">                start_index_((j+1)) = update;</span>
<span class="cm">            }</span>

<span class="cm">        });</span>
<span class="cm">    #else</span>
<span class="cm">    assignment_scan_functor scan_execution_functor(temp);</span>
<span class="cm">    Kokkos::parallel_scan(&quot;StartValues&quot;, dim2_, scan_execution_functor);</span>
<span class="cm">    #endif</span>
<span class="cm">    Kokkos::fence();</span>
<span class="cm">    */</span><span class="w"></span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">    size_t * h_start_index = new size_t [dim1_+1];</span>
<span class="cm">    h_start_index[0] = 0;</span>
<span class="cm">    size_t * herenow = new size_t [2];</span>
<span class="cm">    herenow[0] = 1;</span>
<span class="cm">    herenow[1] = 2;</span>
<span class="cm">    size_t count = 0;</span>
<span class="cm">    for (size_t i = 0; i &lt; dim1_; i++){</span>
<span class="cm">        count += herenow[i];</span>
<span class="cm">        h_start_index[(i + 1)] = count;</span>
<span class="cm">        printf(&quot;%d) Start check %ld\n&quot;, i, h_start_index[i]);</span>
<span class="cm">    } // end for i</span>
<span class="cm">    */</span><span class="w"></span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">    SArray1D templen = SArray1D(&quot;templen&quot;, 1);</span>
<span class="cm">    auto h_templen = Kokkos::create_mirror_view(templen);</span>
<span class="cm">    #ifdef HAVE_CLASS_LAMBDA</span>
<span class="cm">    Kokkos::parallel_for(&quot;ArrayLength&quot;, 1, KOKKOS_CLASS_LAMBDA(const int&amp;) {</span>
<span class="cm">            templen(0) = start_index_(dim2_);</span>
<span class="cm">            //length_ = start_index_(dim2_);</span>
<span class="cm">        });</span>
<span class="cm">    #else</span>
<span class="cm">    templen_functor templen_execution_functor(templen);</span>
<span class="cm">    Kokkos::parallel_for(&quot;ArrayLength&quot;, 1, templen_execution_functor);</span>
<span class="cm">    #endif</span>
<span class="cm">    Kokkos::fence();</span>
<span class="cm">    deep_copy(h_templen, templen);</span>
<span class="cm">    length_ = h_templen(0);</span>

<span class="cm">    printf(&quot;Length %ld\n&quot;, length_);</span>

<span class="cm">    #ifdef HAVE_CLASS_LAMBDA</span>
<span class="cm">    Kokkos::parallel_for(&quot;StartCheck&quot;, dim2_+1, KOKKOS_CLASS_LAMBDA(const int j) {</span>
<span class="cm">            printf(&quot;%d) Start %ld\n&quot;, j, start_index_(j));</span>
<span class="cm">        });</span>
<span class="cm">    #else</span>
<span class="cm">    stride_check_functor check_execution_functor;</span>
<span class="cm">    Kokkos::parallel_for(&quot;StartCheck&quot;, dim2_+1, check_execution_functor);</span>
<span class="cm">    #endif</span>
<span class="cm">    Kokkos::fence();</span>
<span class="cm">    */</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">mystrides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">mystrides_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">        dim1_ = temp.dim1_;</span>
<span class="cm">        length_ = temp.length_;</span>
<span class="cm">        start_index_ = SArray1D(&quot;start_index_&quot;, dim1_ + 1);</span>
<span class="cm">        Kokkos::parallel_for(&quot;EqualOperator&quot;, dim1_+1, KOKKOS_CLASS_LAMBDA(const int j) {</span>
<span class="cm">                start_index_(j) = temp.start_index_(j);</span>
<span class="cm">            });</span>
<span class="cm">        //for (int j = 0; j &lt; dim1_; j++) {</span>
<span class="cm">        //    start_index_(j) = temp.start_index_(j);</span>
<span class="cm">        //}</span>
<span class="cm">        array_ = TArray1D(&quot;array_&quot;, length_);</span>
<span class="cm">    */</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return the stored Kokkos view</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="n">RaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::</span><span class="n">get_kokkos_view</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Destructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ILayout</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">RaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="p">,</span><span class="n">ILayout</span><span class="o">&gt;::~</span><span class="n">RaggedDownArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="c1">// End of RaggedDownArrayKokkos</span>

<span class="c1">//11. DynamicRaggedRightArray</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DynamicRaggedRightArrayKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">SArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// THIS WILL BE A GPU POINTER!</span>
<span class="w">    </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Default constructor</span>
<span class="w">    </span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//--- 2D array access of a ragged right array ---</span>

<span class="w">    </span><span class="c1">// overload constructor</span>
<span class="w">    </span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return or set the stride size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return the size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return the view</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload operator() to access data as array(i,j),</span>
<span class="w">    </span><span class="c1">// where i=[0:N-1], j=[stride(i)]</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload copy assignment operator</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//kokkos policy functors</span>

<span class="w">    </span><span class="c1">//functors for kokkos execution policies</span>
<span class="w">    </span><span class="c1">//set strides to a constant value</span>
<span class="w">    </span><span class="k">class</span> <span class="nc">set_strides_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">      </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">functor_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">init_stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="n">set_strides_functor</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">init_stride</span><span class="p">,</span><span class="w"> </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">init_stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">init_stride</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">functor_strides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">functor_strides_</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">init_stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Destructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="w"> </span><span class="p">();</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">//nothing</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DynamicRaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DynamicRaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// The dimensions of the array;</span>
<span class="w">    </span><span class="n">dim1_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dim2_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">append_stride_string</span><span class="p">(</span><span class="s">&quot;strides&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">append_array_string</span><span class="p">(</span><span class="s">&quot;array&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tag_string</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">strides_tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">append_stride_string</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">temp_copy_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tag_string</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">array_tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">append_array_string</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SArray1D</span><span class="p">(</span><span class="n">strides_tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_for</span><span class="p">(</span><span class="s">&quot;StridesInit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">strides_</span><span class="p">((</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">set_strides_functor</span><span class="w"> </span><span class="nf">execution_functor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">stride_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_for</span><span class="p">(</span><span class="s">&quot;StridesInit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="n">execution_functor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>

<span class="w">    </span><span class="c1">//allocate view</span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">array_tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// A method to set the stride size for row i</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">stride_</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Overload operator() to access data as array(i,j),</span>
<span class="c1">// where i=[0:N-1], j=[0:stride(i)]</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Asserts</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of dim1 bounds in DynamicRaggedRight&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim1</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">stride_</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of stride bounds in DynamicRaggedRight&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>
<span class="w">    </span><span class="c1">// Cannot assert on Kokkos View</span>
<span class="w">    </span><span class="c1">//assert(j &lt; stride_[i] &amp;&amp; &quot;j is out of stride bounds in DynamicRaggedRight&quot;);  // die if &gt;= stride</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="o">*</span><span class="n">dim2_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//overload = operator</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DynamicRaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"></span>
<span class="w">       </span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="cm">/*</span>
<span class="cm">        #ifdef HAVE_CLASS_LAMBDA</span>
<span class="cm">        Kokkos::parallel_for(&quot;StrideZeroOut&quot;, dim1_, KOKKOS_CLASS_LAMBDA(const int i) {</span>
<span class="cm">            stride_(i) = 0;</span>
<span class="cm">        });</span>
<span class="cm">        #else</span>
<span class="cm">        stride_zero_functor execution_functor;</span>
<span class="cm">        Kokkos::parallel_for(&quot;StrideZeroOut&quot;, dim1_, execution_functor);</span>
<span class="cm">        #endif</span>
<span class="cm">        */</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return the stored Kokkos view</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">get_kokkos_view</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Destructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DynamicRaggedRightArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">DynamicRaggedRightArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>




<span class="c1">//----end DynamicRaggedRightArray class definitions----</span>


<span class="c1">//12. DynamicRaggedDownArray</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">DynamicRaggedDownArrayKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">SArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Default constructor</span>
<span class="w">    </span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="w"> </span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">//--- 2D array access of a ragged right array ---</span>

<span class="w">    </span><span class="c1">// overload constructor</span>
<span class="w">    </span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULTSTRINGARRAY</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return or set the stride size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// A method to return the size</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">//return the view</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload operator() to access data as array(i,j),</span>
<span class="w">    </span><span class="c1">// where i=[stride(j)], j=[0:N-1]</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Overload copy assignment operator</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">//kokkos policy functors</span>
<span class="w">    </span><span class="c1">//set strides to 0 functor</span>
<span class="w">    </span><span class="c1">//set strides to a constant value</span>
<span class="w">    </span><span class="k">class</span> <span class="nc">set_strides_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">      </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">functor_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">init_stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="n">set_strides_functor</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">init_stride</span><span class="p">,</span><span class="w"> </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="n">init_stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">init_stride</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">functor_strides_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_strides_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">functor_strides_</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">init_stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Destructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="w"> </span><span class="p">();</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="c1">//nothing</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DynamicRaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Overloaded constructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">DynamicRaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// The dimensions of the array;</span>
<span class="w">    </span><span class="n">dim1_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dim2_</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="o">*</span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">append_stride_string</span><span class="p">(</span><span class="s">&quot;strides&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">append_array_string</span><span class="p">(</span><span class="s">&quot;array&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tag_string</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">strides_tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">append_stride_string</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">temp_copy_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tag_string</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">array_tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">append_array_string</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SArray1D</span><span class="p">(</span><span class="n">strides_tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">dim2_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_for</span><span class="p">(</span><span class="s">&quot;StridesInit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim2_</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">strides_</span><span class="p">((</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">set_strides_functor</span><span class="w"> </span><span class="nf">execution_functor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">stride_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_for</span><span class="p">(</span><span class="s">&quot;StridesInit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim2_</span><span class="p">,</span><span class="n">execution_functor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>

<span class="w">    </span><span class="c1">//allocate view</span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="n">array_tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">length_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// A method to set the stride size for column j</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">stride_</span><span class="p">(</span><span class="n">j</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return size</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// overload operator () to access data as an array(i,j)</span>
<span class="c1">// Note: i = 0:stride(j), j = 0:N-1</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Asserts</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;j is out of dim2 bounds in DynamicRaggedDownArrayKokkos&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= dim2</span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">stride</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of stride bounds in DynamicRaggedDownArrayKokkos&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// die if &gt;= stride(j)</span>
<span class="w">    </span><span class="c1">// Can&#39;t do this assert with a Kokkos View</span>
<span class="w">    </span><span class="c1">//assert(i &lt; stride_[j] &amp;&amp; &quot;i is out of stride bounds in DynamicRaggedDownArrayKokkos&quot;);  // die if &gt;= stride</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="o">*</span><span class="n">dim1_</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//overload = operator</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DynamicRaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"></span>
<span class="w">  </span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">length_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">length_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">stride_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">stride_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="cm">/*</span>
<span class="cm">        #ifdef HAVE_CLASS_LAMBDA</span>
<span class="cm">        Kokkos::parallel_for(&quot;StrideZeroOut&quot;, dim2_, KOKKOS_CLASS_LAMBDA(const int j) {</span>
<span class="cm">            stride_(j) = 0;</span>
<span class="cm">        });</span>
<span class="cm">        #else</span>
<span class="cm">        stride_zero_functor execution_functor;</span>
<span class="cm">        Kokkos::parallel_for(&quot;StrideZeroOut&quot;, dim2_, execution_functor);</span>
<span class="cm">        #endif</span>
<span class="cm">        */</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//return the stored Kokkos view</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">get_kokkos_view</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Destructor</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">DynamicRaggedDownArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">DynamicRaggedDownArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="c1">// KokkosCSRArray</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">CSRArrayKokkos</span><span class="w"> </span><span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">SArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">private</span><span class="o">:</span><span class="w"> </span><span class="c1">// What ought to be private ?</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">column_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">miss_</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">    </span><span class="n">CSRArrayKokkos</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="c1">//CSRArray(CArray&lt;T&gt; data, CArray&lt;T&gt; col_ptrs, CArray&lt;T&gt; row_ptrs, size_t rows, size_t cols);</span>

<span class="w">   </span><span class="n">CSRArrayKokkos</span><span class="p">(</span><span class="w"></span>
<span class="w">               </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">start_index</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">colum_index</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">);</span><span class="w"></span>


<span class="w">    </span><span class="c1">//KOKKOS_INLINE_FUNCTION</span>
<span class="w">    </span><span class="n">CSRArrayKokkos</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">dense</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">data_setup</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">value</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">CSRArrayKokkos</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>


<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>


<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">begin</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">end</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>


<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * @brief get values from dense array</span>
<span class="cm">     */</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">from_dense</span><span class="p">(</span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">starts</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">columns</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * iterator for the raw data at row i</span>
<span class="cm">     * i.e. return the index each element is the index in the 1 array</span>
<span class="cm">     *  This as the use of providing a reasonable way to get the column</span>
<span class="cm">     * index and data value in the case you need both</span>
<span class="cm">    */</span><span class="w"></span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">begin_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">end_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nnz</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nnz</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Use the index into the 1d array to get what value is stored there and what is the corresponding row</span>
<span class="w">    </span><span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">get_val_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">get_col_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// reverse map function from A(i,j) to what element of data/col_pt_ it corersponds to</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">flat_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Convertor</span>

<span class="w">    </span><span class="c1">// int toCSC(CArray&lt;T&gt; &amp;data, CArray&lt;size_t&gt; &amp;col_ptrs, CArray&lt;size_t&gt; &amp;row_ptrs);</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">to_dense</span><span class="p">(</span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">A</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">class</span> <span class="nc">init_start_indices_functor</span><span class="p">{</span><span class="w"></span>
<span class="w">       </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">              </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">mystart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">              </span><span class="n">init_start_indices_functor</span><span class="p">(</span><span class="n">SArray1D</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">){</span><span class="w"></span>
<span class="w">                     </span><span class="n">mystart_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempstart_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">              </span><span class="p">}</span><span class="w"></span>
<span class="w">              </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="p">()(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                      </span><span class="n">mystart_index_</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">             </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="c1">//destructor</span>
<span class="w">    </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">    </span><span class="o">~</span><span class="n">CSRArrayKokkos</span><span class="p">();</span><span class="w"></span>


<span class="p">};</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CSRArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CSRArrayKokkos</span><span class="p">(</span><span class="w"></span>
<span class="w">               </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">start_index</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">colum_index</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index</span><span class="p">.</span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">.</span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">column_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colum_index</span><span class="p">.</span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">nnz_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colum_index</span><span class="p">.</span><span class="n">extent</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">miss_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="s">&quot;miss&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="cm">/*</span>
<span class="cm">template&lt;typename T, typename Layout, typename ExecSpace, typename MemoryTraits&gt;</span>
<span class="cm">KOKKOS_INLINE_FUNCTION</span>
<span class="cm">CSRArrayKokkos&lt;T,Layout, ExecSpace,MemoryTraits&gt;::CSRArrayKokkos(const CArrayKokkos&lt;T, Layout, ExecSpace, MemoryTraits&gt; &amp;dense, const size_t dim1, const size_t dim2){</span>
<span class="cm">    dim1_ = dim1;</span>
<span class="cm">    dim2_ = dim2;</span>
<span class="cm">    miss_ = TArray1D(&quot;miss&quot;,1);</span>
<span class="cm">    start_index_ = Kokkos::View&lt;size_t*&gt;(&quot;start indices&quot;, dim1 + 1);</span>
<span class="cm">    nnz_ = 0;</span>


<span class="cm">    start_index_(0) = 0;</span>
<span class="cm">    // TODO MAKE parallel</span>
<span class="cm">    for(size_t i = 0; i &lt; dim1_; i++){</span>
<span class="cm">        start_index_(i+1) = 0;</span>
<span class="cm">        for(size_t j =0; j &lt; dim2_; j++){</span>
<span class="cm">                if(dense(i,j) != 0){</span>
<span class="cm">                        start_index_(i+1) ++;</span>
<span class="cm">                        nnz_++;</span>
<span class="cm">                }</span>
<span class="cm">        }</span>
<span class="cm">   }</span>


<span class="cm">    for(size_t i = 1; i &lt; dim1_ + 1; i++){</span>
<span class="cm">            start_index_(i) = start_index_[i] + start_index_[i-1];</span>
<span class="cm">    }</span>

<span class="cm">    column_index_ = Kokkos::View&lt;size_t*&gt;(&quot;column Indices&quot;, nnz_);</span>
<span class="cm">    array_ = Kokkos::View&lt;T*&gt;(&quot;array elements&quot;, nnz_);</span>
<span class="cm">    size_t next = 0 ;</span>
<span class="cm">    for(size_t i = 0; i &lt; dim1_; i++){</span>
<span class="cm">            for(size_t j =0 ; j &lt; dim2_; j++){</span>
<span class="cm">                    if(dense(i,j) != 0){</span>
<span class="cm">         //               column_index_(next) = j;</span>
<span class="cm">         //               array_(next) = dense(i,j);</span>
<span class="cm">                        next++;</span>
<span class="cm">                    }</span>
<span class="cm">            }</span>
<span class="cm">    }</span>
<span class="cm">}</span>
<span class="cm">*/</span><span class="w"></span>

<span class="c1">//setup start indices</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">data_setup</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//allocate start indices</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="nf">append_indices_string</span><span class="p">(</span><span class="s">&quot;start_indices&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tag_string</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">start_index_tag_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_copy_string</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">append_indices_string</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">temp_copy_string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tag_string</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SArray1D</span><span class="p">(</span><span class="n">start_index_tag_string</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#ifdef HAVE_CLASS_LAMBDA</span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_for</span><span class="p">(</span><span class="s">&quot;StartValuesInit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_CLASS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">start_index_</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="cp">#else</span>
<span class="w">    </span><span class="n">init_start_indices_functor</span><span class="w"> </span><span class="nf">execution_functor</span><span class="p">(</span><span class="n">start_index_</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_for</span><span class="p">(</span><span class="s">&quot;StartValuesInit&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dim1_</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">execution_functor</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="cp">#endif</span>

<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">row_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">row_start</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">column_index_</span><span class="p">[</span><span class="n">row_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">row_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">miss_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">miss_</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">value</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">row_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">row_start</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">column_index_</span><span class="p">[</span><span class="n">row_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">row_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">miss_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">miss_</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">nnz_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">column_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">column_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">void</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">to_dense</span><span class="p">(</span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">A</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="n">A</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Index i out of bounds in CSRArray.stride()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="o">+</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dim2</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dim1</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">begin</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CSRArray.begin()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">row_start</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">end</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CSRArray.end()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">row_start</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">begin_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CSRArray.begin_index()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">end_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim1_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CSRArray.begin_index()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">nnz</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">nnz</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">nrows_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Index i out of bounds in CSRArray.stride()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">get_val_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">){</span><span class="w"></span>
<span class="w">   </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nnz_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Index k is out of bounds in CSRArray.get_val_flat()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">get_col_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nnz_f</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;Index k is out of bounds in CSRArray.get_col_lat()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">column_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">flat_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">row_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">row_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">row_start</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">column_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">row_start</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">){</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">row_start</span><span class="o">+</span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="mi">-1</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">//template&lt;typename T, typename Layout, typename ExecSpace, typename MemoryTraits&gt;</span>
<span class="c1">//void CSRArrrayKokkos&lt;T,Layout,ExecSpace, MemoryTraits&gt;::from_dense(CArrayKokkos&lt;T, Layout, ExecSpace, MemoryTraits&gt; &amp;starts,</span>
<span class="c1">//                    CArrayKokkos&lt;T, Layout, ExecSpace, MemoryTraits&gt; &amp;columns,</span>
<span class="c1">//                    CArrayKokkos&lt;T, Layout, ExecSpace, MemoryTraits&gt; &amp;array);</span>

<span class="w">                    </span><span class="cm">/*</span>
<span class="cm">int CSRArray&lt;T&gt;::toCSC(CArray&lt;T&gt; &amp;data, CArray&lt;size_t&gt; &amp;col_ptrs, CArray&lt;size_t&gt; &amp;row_ptrs ){</span>
<span class="cm">    int nnz_cols[ncols_ + 1];</span>
<span class="cm">    int col_counts[ncols_];</span>
<span class="cm">    int i = 0;</span>
<span class="cm">    // How many elements are each column</span>
<span class="cm">    for(i =0 ; i &lt; ncols_; i++){</span>
<span class="cm">        nnz_cols[i] = 0;</span>
<span class="cm">        col_counts[i] = 0;</span>
<span class="cm">    }</span>
<span class="cm">    nnz_cols[ncols_] = 0;</span>
<span class="cm">    col_ptrs(0) = 0;</span>
<span class="cm">    for(i =0; i &lt; nnz_; i++){</span>
<span class="cm">        nnz_cols[column_index_[i] + 1] += 1;</span>
<span class="cm">    }</span>
<span class="cm">    // What we actually care about is how many elements are</span>
<span class="cm">    // in all the  columns preceeding this column.</span>
<span class="cm">    for(i = 1; i &lt;= ncols_; i++){</span>
<span class="cm">        nnz_cols[i] = nnz_cols[i-1] + nnz_cols[i];</span>
<span class="cm">        col_ptrs(i) = nnz_cols[i];</span>
<span class="cm">    }</span>
<span class="cm">    size_t row = 1;</span>
<span class="cm">    // if b is at A(i,j)  stored in csr format</span>
<span class="cm">    // it needs to go where the where the ith column starts</span>
<span class="cm">    // + how many things we have put in the &quot;window&quot;</span>
<span class="cm">    // we allocated for this column already</span>
<span class="cm">    // For row we simply keep track of what row we are currently in</span>
<span class="cm">    // as we scan through the 1d array of data.</span>
<span class="cm">    for(i = 0; i &lt; nnz_; i++){</span>
<span class="cm">        if(i &gt;= start_index_[row]){</span>
<span class="cm">            row++;</span>
<span class="cm">        }</span>
<span class="cm">        int idx = nnz_cols[column_index_[i]] + col_counts[column_index_[i]];</span>
<span class="cm">        col_counts[column_index_[i]] += 1;</span>
<span class="cm">        data(idx) = array_[i];</span>
<span class="cm">        row_ptrs(idx) = row - 1;</span>
<span class="cm">    }</span>
<span class="cm">    // I return an int because I thought I might need to return an error code</span>
<span class="cm">    // Not sure that is true</span>
<span class="cm">    return 0;</span>
<span class="cm">}</span>
<span class="cm">*/</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSRArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">CSRArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// 16 CSCArrayKokkos</span>
<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultLayout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DefaultExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">void</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">class</span> <span class="nc">CSCArrayKokkos</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">TArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="n">T</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">SArray1D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">View</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">private</span><span class="o">:</span><span class="w"> </span><span class="c1">// What ought to be private ?</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1_</span><span class="p">,</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">TArray1D</span><span class="w"> </span><span class="n">miss_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">SArray1D</span><span class="w"> </span><span class="n">row_index_</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">public</span><span class="o">:</span><span class="w"></span>

<span class="w">      </span><span class="n">CSCArrayKokkos</span><span class="p">();</span><span class="w"></span>

<span class="w">     </span><span class="n">CSCArrayKokkos</span><span class="p">(</span><span class="w"></span>
<span class="w">               </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">start_index</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">row_index</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">);</span><span class="w"></span>


<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">&amp;</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="n">CSCArrayKokkos</span><span class="w"> </span><span class="o">&amp;</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">&amp;</span><span class="n">value</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">begin</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="n">end</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="c1">// iterator for the raw data at row i</span>
<span class="w">      </span><span class="c1">// i.e. return the index each element is the index in the 1 array</span>
<span class="w">      </span><span class="c1">// This as the use of providing a reasonable way to get the column</span>
<span class="w">      </span><span class="c1">// index and data value in the case you need both</span>
<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">begin_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">end_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nnz</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">nnz</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">;</span><span class="w"></span>

<span class="w">      </span><span class="c1">// Use the index into the 1d array to get what value is stored there and what is the corresponding row</span>
<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="n">T</span><span class="w"> </span><span class="o">&amp;</span><span class="n">get_val_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="kt">size_t</span><span class="w"> </span><span class="n">get_row_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="c1">// reverse map function from A(i,j) to what element of data/col_pt_ it corersponds to</span>
<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">flat_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">);</span><span class="w"></span>

<span class="w">      </span><span class="c1">// Convertor</span>
<span class="w">      </span><span class="c1">//int toCSR(CArray&lt;T&gt; &amp;data, CArray&lt;size_t&gt; &amp;row_ptrs, CArray&lt;size_t&gt; &amp;col_ptrs);</span>
<span class="w">      </span><span class="c1">//void to_dense(FArray&lt;T&gt; &amp;A);</span>
<span class="w">      </span><span class="c1">// destructor</span>
<span class="w">      </span><span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="w">      </span><span class="o">~</span><span class="n">CSCArrayKokkos</span><span class="p">();</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CSCArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">CSCArrayKokkos</span><span class="p">(</span><span class="w"></span>
<span class="w">               </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">start_index</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="n">CArrayKokkos</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">row_index</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim1</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dim2</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">tag_string</span><span class="p">){</span><span class="w"></span>

<span class="w">    </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dim2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index</span><span class="p">.</span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">.</span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">row_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row_index</span><span class="p">.</span><span class="n">get_kokkos_view</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">nnz_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row_index</span><span class="p">.</span><span class="n">extent</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">miss_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TArray1D</span><span class="p">(</span><span class="s">&quot;miss&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="p">()(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">col_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">col_start</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">row_index_</span><span class="p">[</span><span class="n">col_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">col_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="c1">//return array_.data()[nnz_];</span>
<span class="w">    </span><span class="n">miss_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">miss_</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">pointer</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">value</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">j</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">col_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">col_start</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">row_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">col_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">col_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">miss_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">miss_</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="o">*</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">get_starts</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">nnz_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim2_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">dim1_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">dim1_</span><span class="p">;;</span><span class="w"></span>

<span class="w">        </span><span class="n">start_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">start_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">row_index_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">row_row_index_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">array_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">.</span><span class="n">array_</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="k">this</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">stride</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;i is out of bounds in CSCArray.stride()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>


<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dim1</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dim1_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">dim2</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">dim2_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">begin</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;index i out of bounds at CSCArray.begin()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">col_start</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">*</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">end</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim2s_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;index i out of bounds at CSCArray.endt()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">col_start</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">begin_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim2s_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;index i out of bounds at CSCArray.begin_index()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">end_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dim2_</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s">&quot;index i out of bounds at CSCArray.end_index()&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">nnz</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">nnz_</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">nnz</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">i</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="n">T</span><span class="o">&amp;</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">get_val_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">array_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">get_row_flat</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">row_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">k</span><span class="p">];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">KOKKOS_INLINE_FUNCTION</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="n">MemoryTraits</span><span class="o">&gt;::</span><span class="n">flat_index</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">j</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">j</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">col_end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">col_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">col_start</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">row_index_</span><span class="p">.</span><span class="n">data</span><span class="p">()[</span><span class="n">col_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">){</span><span class="w"></span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">col_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">k</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w">  </span><span class="mi">-1</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Assumes that data, col_ptrs, and row_ptrs</span>
<span class="c1">// have been allocated size already before this call</span>
<span class="c1">// Returns the data in this csr format but as represented as the appropriatte vectors</span>
<span class="c1">// for a csc format</span>
<span class="cm">/*template&lt;typename T&gt;</span>
<span class="cm">int CSCArray&lt;T&gt;::toCSR(CArray&lt;T&gt; &amp;data, CArray&lt;size_t&gt; &amp;col_ptrs, CArray&lt;size_t&gt; &amp;row_ptrs ){</span>
<span class="cm">    int nnz_rows[dim1_ + 1];</span>
<span class="cm">    int row_counts[dim1_];</span>
<span class="cm">    int i = 0;</span>
<span class="cm">    // How many elements are each column</span>
<span class="cm">    for(i =0 ; i &lt; dim1_; i++){</span>
<span class="cm">        nnz_rows[i] = 0;</span>
<span class="cm">        row_counts[i] = 0;</span>
<span class="cm">    }</span>
<span class="cm">    nnz_rows[dim1_] = 0;</span>
<span class="cm">    row_ptrs(i) = 0 ;</span>
<span class="cm">    for(i =0; i &lt; nnz_; i++){</span>
<span class="cm">        nnz_rows[row_index_[i] + 1] += 1;</span>
<span class="cm">    }</span>
<span class="cm">    // What we actually care about is how many elements are</span>
<span class="cm">    // in all the columns preceeding this column.</span>
<span class="cm">    for(i = 1; i &lt; dim1_; i++){</span>
<span class="cm">        nnz_rows[i] = nnz_rows[i-1] + nnz_rows[i];</span>
<span class="cm">        row_ptrs(i) = nnz_rows[i];</span>
<span class="cm">    }</span>
<span class="cm">    size_t col = 1;</span>
<span class="cm">    // if b is at A(i,j)  stored in csr format</span>
<span class="cm">    // it needs to go where the where the ith column starts</span>
<span class="cm">    // + how many things we have put in the &quot;window&quot;</span>
<span class="cm">    // we allocated for this column already</span>
<span class="cm">    // For row we simply keep track of what row we are currently in</span>
<span class="cm">    // as we scan through the 1d array of data.</span>
<span class="cm">    for(i = 0; i &lt; nnz_; i++){</span>
<span class="cm">        if(i &gt;= start_index_[col]){</span>
<span class="cm">            col++;</span>
<span class="cm">        }</span>
<span class="cm">        int idx = nnz_rows[row_index_[i]] + row_counts[row_index_[i]];</span>
<span class="cm">        row_counts[row_index_[i]] += 1;</span>
<span class="cm">        data(idx) = array_[i];</span>
<span class="cm">        col_ptrs(idx) = col - 1;</span>
<span class="cm">    }</span>
<span class="cm">    // I return an int because I thought I might need to return an error code</span>
<span class="cm">    // Not sure that is true</span>
<span class="cm">    return 0;</span>
<span class="cm">}</span>
<span class="cm">*/</span><span class="w"></span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">Layout</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">ExecSpace</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span> <span class="nc">MemoryTraits</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">CSCArrayKokkos</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="n">Layout</span><span class="p">,</span><span class="n">ExecSpace</span><span class="p">,</span><span class="n">MemoryTraits</span><span class="o">&gt;::~</span><span class="n">CSCArrayKokkos</span><span class="p">()</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="c1">// Inherited Class Array</span>

<span class="cm">/*</span>
<span class="cm">//template&lt;class T, class Layout, class ExecSpace&gt;</span>
<span class="cm">template&lt;typename T&gt;</span>
<span class="cm">class InheritedArray2L {</span>

<span class="cm">    using TArray1D = Kokkos::View&lt;T*, Layout, ExecSpace&gt;;</span>

<span class="cm">private:</span>
<span class="cm">    size_t dim1_, length_;</span>

<span class="cm">public:</span>
<span class="cm">    TArray1D this_array_;</span>
<span class="cm">    typename Kokkos::View&lt;T*, Layout, ExecSpace&gt;::HostMirror  h_this_array_;</span>

<span class="cm">    InheritedArray2L();</span>

<span class="cm">    InheritedArray2L(size_t some_dim1);</span>

<span class="cm">    KOKKOS_INLINE_FUNCTION</span>
<span class="cm">    T&amp; operator()(size_t i, size_t dest) const;</span>

<span class="cm">    template &lt;typename U&gt;</span>
<span class="cm">    void AllocateHost(size_t size, U *obj);</span>

<span class="cm">    void AllocateGPU();</span>

<span class="cm">    template &lt;typename U, typename V&gt;</span>
<span class="cm">    void InitModels(U *obj, V input);</span>

<span class="cm">    template &lt;typename U&gt;</span>
<span class="cm">    void ClearModels(U obj);</span>

<span class="cm">    InheritedArray2L&amp; operator=(const InheritedArray2L&amp; temp);</span>

<span class="cm">    // GPU Method</span>
<span class="cm">    // Method that returns size</span>
<span class="cm">    KOKKOS_INLINE_FUNCTION</span>
<span class="cm">    size_t size();</span>

<span class="cm">    // Host Method</span>
<span class="cm">    // Method that returns size</span>
<span class="cm">    size_t extent();</span>

<span class="cm">    // Methods returns the raw pointer (most likely GPU) of the Kokkos View</span>
<span class="cm">    T* pointer();</span>

<span class="cm">    // Deconstructor</span>
<span class="cm">    KOKKOS_INLINE_FUNCTION</span>
<span class="cm">    ~InheritedArray2L ();</span>
<span class="cm">}; // End of InheritedArray2L</span>

<span class="cm">// Default constructor</span>
<span class="cm">template &lt;typename T&gt;</span>
<span class="cm">InheritedArray2L&lt;T&gt;::InheritedArray2L() {}</span>

<span class="cm">// Overloaded 1D constructor</span>
<span class="cm">template &lt;typename T&gt;</span>
<span class="cm">InheritedArray2L&lt;T&gt;::InheritedArray2L(size_t some_dim1) {</span>
<span class="cm">    using TArray1D = Kokkos::View&lt;T*, Layout, ExecSpace&gt;;</span>

<span class="cm">    dim1_ = some_dim1;</span>
<span class="cm">    length_ = dim1_;</span>
<span class="cm">    this_array_ = TArray1D(&quot;this_array_&quot;, length_);</span>
<span class="cm">    h_this_array_ = Kokkos::create_mirror_view(this_array_);</span>
<span class="cm">}</span>

<span class="cm">template &lt;typename T&gt;</span>
<span class="cm">KOKKOS_INLINE_FUNCTION</span>
<span class="cm">T&amp; InheritedArray2L&lt;T&gt;::operator()(size_t i, size_t dest) const {</span>
<span class="cm">    assert(i &lt; dim1_ &amp;&amp; &quot;i is out of bounds in InheritedArray2L 1D!&quot;);</span>
<span class="cm">    assert(dest &lt; 2 &amp;&amp; &quot;dest is out of bounds in InheritedArray2L 1D!&quot;);</span>
<span class="cm">    if (dest == 0)</span>
<span class="cm">        return h_this_array_(i);</span>
<span class="cm">    else</span>
<span class="cm">        return this_array_(i);</span>
<span class="cm">}</span>

<span class="cm">template &lt;typename T&gt;</span>
<span class="cm">template &lt;typename U&gt;</span>
<span class="cm">void InheritedArray2L&lt;T&gt;::AllocateHost(size_t size, U *obj) {</span>
<span class="cm">    obj = (U *) kmalloc(size);</span>
<span class="cm">}</span>

<span class="cm">template &lt;typename T&gt;</span>
<span class="cm">void InheritedArray2L&lt;T&gt;::AllocateGPU() {</span>
<span class="cm">    Kokkos::deep_copy(this_array_, h_this_array_);</span>
<span class="cm">}</span>

<span class="cm">template &lt;typename T&gt;</span>
<span class="cm">template &lt;typename U, typename V&gt;</span>
<span class="cm">void InheritedArray2L&lt;T&gt;::InitModels(U *obj, V input) {</span>
<span class="cm">    Kokkos::parallel_for(</span>
<span class="cm">            &quot;CreateObjects&quot;, 1, KOKKOS_CLASS_LAMBDA(const int&amp;) {</span>
<span class="cm">                new ((V *)obj) V{input};</span>
<span class="cm">            });</span>
<span class="cm">}</span>

<span class="cm">template &lt;typename T&gt;</span>
<span class="cm">template &lt;typename U&gt;</span>
<span class="cm">void InheritedArray2L&lt;T&gt;::ClearModels(U obj) {</span>
<span class="cm">    Kokkos::parallel_for(</span>
<span class="cm">            &quot;DestroyObjects&quot;, 1, KOKKOS_LAMBDA(const int&amp;) {</span>
<span class="cm">              this_array_(0).obj-&gt;~U();</span>
<span class="cm">              this_array_(1).obj-&gt;~U();</span>
<span class="cm">            });</span>
<span class="cm">}</span>

<span class="cm">template &lt;typename T&gt;</span>
<span class="cm">InheritedArray2L&lt;T&gt;&amp; InheritedArray2L&lt;T&gt;::operator= (const InheritedArray2L&amp; temp) {</span>
<span class="cm">    using TArray1D = Kokkos::View&lt;T *,Layout,ExecSpace&gt;;</span>

<span class="cm">    // Do nothing if the assignment is of the form x = x</span>
<span class="cm">    if (this != &amp;temp) {</span>
<span class="cm">        dim1_ = temp.dim1_;</span>
<span class="cm">        length_ = temp.length_;</span>
<span class="cm">        this_array_ = TArray1D(&quot;this_array_&quot;, length_);</span>
<span class="cm">    }</span>

<span class="cm">    return *this;</span>
<span class="cm">}</span>

<span class="cm">// Return size</span>
<span class="cm">template &lt;typename T&gt;</span>
<span class="cm">KOKKOS_INLINE_FUNCTION</span>
<span class="cm">size_t InheritedArray2L&lt;T&gt;::size() {</span>
<span class="cm">    return length_;</span>
<span class="cm">}</span>

<span class="cm">template &lt;typename T&gt;</span>
<span class="cm">size_t InheritedArray2L&lt;T&gt;::extent() {</span>
<span class="cm">    return length_;</span>
<span class="cm">}</span>

<span class="cm">template &lt;typename T&gt;</span>
<span class="cm">T* InheritedArray2L&lt;T&gt;::pointer() {</span>
<span class="cm">    return this_array_.data();</span>
<span class="cm">}</span>

<span class="cm">template &lt;typename T&gt;</span>
<span class="cm">KOKKOS_INLINE_FUNCTION</span>
<span class="cm">InheritedArray2L&lt;T&gt;::~InheritedArray2L() {}</span>
<span class="cm">*/</span><span class="w"></span>

<span class="c1">// End of InheritedArray2L</span>


<span class="c1">// #endif</span>







<span class="cp">#endif </span><span class="c1">// MATAR_H</span>
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, me.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>